<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Routing w Railsach</title>
  <!--[if lt IE 8]>
  <script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js" type="text/javascript"></script>
  <![endif]-->
  <link href="stylesheets/base.css" media="screen" rel="Stylesheet" type="text/css" />
  <link href="stylesheets/forms.css" media="screen" rel="Stylesheet" type="text/css" />
  <link href="stylesheets/more.css" media="screen" rel="Stylesheet" type="text/css" />
</head>
<body>
  <div id="header" >
    <div id="logo">
      <a href="index.html" title="Ruby on Rails"><img src="images/rails_logo_remix.gif" alt="Rails" height="140" width="110" /></a>
    </div>

    <h1 id="site_title"><span>Ruby on Rails</span></h1>
    <h2 id="site_title_tagline">Sustainable productivity for web-application development</h2>

    <ul id="navMain">
      <li class="first-child"><a href="http://www.rubyonrails.org/" title="Ruby on Rails" class="ruby_on_rails">Ruby on Rails</a></li>
      <li><a class="manuals" href="index.html" title="Manuals Index">Guides Index</a></li>
    </ul>
  </div>

  <div id="container">
    
    <div id="sidebar">
      <h2>Chapters</h2>
      <ol>
          <li>
          <a href="#_podw_jny_cel_routingu">Podwójny cel routingu</a>
            <ul>
            
              <li><a href="#_czenie_adresu_url_z_kodem">Łączenie adresu URL z kodem</a></li>
            
              <li><a href="#_generowanie_adresu_url_z_kodu_r_d_owego">Generowanie adresu URL z kodu źródłowego</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_kr_tki_przegl_d_routes_rb">Krótki przegląd routes.rb</a>
            <ul>
            
              <li><a href="#_przetwarzanie_pliku">Przetwarzanie pliku</a></li>
            
              <li><a href="#_drogi_restful">Drogi RESTful</a></li>
            
              <li><a href="#_drogi_nazwane">Drogi nazwane</a></li>
            
              <li><a href="#_drogi_zagnie_d_one">Drogi zagnieżdżone</a></li>
            
              <li><a href="#_drogi_regularne">Drogi regularne</a></li>
            
              <li><a href="#_drogi_domy_lne">Drogi domyślne</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_routing_restful_domy_lny_routing_rails_w">Routing RESTful: domyślny routing Railsów</a>
            <ul>
            
              <li><a href="#_czym_jest_rest">Czym jest REST?</a></li>
            
              <li><a href="#_crud_typy_da_i_akcje">CRUD, typy żądań i akcje</a></li>
            
              <li><a href="#_adresy_url_i_cie_ki_dost_pu">Adresy URL i ścieżki dostępu</a></li>
            
              <li><a href="#_definiowanie_kilku_zasob_w_jednocze_nie">Definiowanie kilku zasobów jednocześnie</a></li>
            
              <li><a href="#_pojedyncze_zasoby">Pojedyncze zasoby</a></li>
            
              <li><a href="#_dopasowanie_zasob_w">Dopasowanie zasobów</a></li>
            
              <li><a href="#_routing_a_przestrzenie_nazw_kontroler_w">Routing a przestrzenie nazw kontrolerów</a></li>
            
              <li><a href="#_zasoby_zagnie_d_one">Zasoby zagnieżdżone</a></li>
            
              <li><a href="#_generowanie_drogi_routingu_z_tablic">Generowanie drogi routingu z tablic</a></li>
            
              <li><a href="#_zasoby_z_przestrzeni_nazw">Zasoby z przestrzenią nazw</a></li>
            
              <li><a href="#_dodawanie_wi_kszej_liczby_akcji_restful">Dodawanie większej liczby akcji RESTful</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_drogi_regularne_2">Drogi regularne</a>
            <ul>
            
              <li><a href="#_podstawowe_parametry">Podstawowe parametry</a></li>
            
              <li><a href="#_komponenty_z_dzik_kart">Komponenty z "dziką kartą"</a></li>
            
              <li><a href="#_tekst_statyczny">Tekst statyczny</a></li>
            
              <li><a href="#_parametry_a_cucha_zapytania_querystring">Parametry łańcucha zapytania (querystring)</a></li>
            
              <li><a href="#_domy_lne_definicje">Domyślne definicje</a></li>
            
              <li><a href="#_drogi_nazwane_2">Drogi nazwane</a></li>
            
              <li><a href="#_wymagania_dr_g_routingu">Wymagania dróg routingu</a></li>
            
              <li><a href="#_warunki_dr_g_routingu">Warunki dróg routingu</a></li>
            
              <li><a href="#_uog_lnianie_dr_g_routingu">Uogólnianie dróg routingu</a></li>
            
              <li><a href="#_opcje_dr_g_routingu">Opcje dróg routingu</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_formaty_i_polecenie_respond_to">Formaty i polecenie respond_to</a>
            <ul>
            
              <li><a href="#_rozr_nianie_formatu_na_podstawie_nag_wka_dania_http">Rozróżnianie formatu na podstawie nagłówka żądania HTTP</a></li>
            
              <li><a href="#_rozpoznawalne_typy_mime">Rozpoznawalne typy MIME</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_drogi_domy_lne_2">Drogi domyślne</a>
          </li>
          <li>
          <a href="#_pusta_droga_routingu">Pusta droga routingu</a>
            <ul>
            
              <li><a href="#_u_ywanie_map_root">Używanie map.root</a></li>
            
              <li><a href="#_czenie_pustego_a_cucha_znak_w">Łączenie pustego łańcucha znaków</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_inspekcja_i_testowanie_dr_g_routingu">Inspekcja i testowanie dróg routingu</a>
            <ul>
            
              <li><a href="#_przel_danie_istniej_cych_dr_g_routingu_poprzez_rake">Przelądanie istniejących dróg routingu poprzez Rake</a></li>
            
              <li><a href="#_testowanie_dr_g_routingu">Testowanie dróg routingu</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_changelog">Changelog</a>
          </li>
      </ol>
    </div>
    
    <div id="content">
        <h1>Routing w Railsach</h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Poniższy tekst to przewodnik po opcjach związanych z routingiem (routing) w frameworku Rails, z którymi spotykają użytkownicy. W oparciu o niego, będziesz mógł:</p></div>
<div class="ulist"><ul>
<li>
<p>
Poznać i zrozimieć sens routingu
</p>
</li>
<li>
<p>
Rozszyfrować kod pliku <tt>routes.rb</tt>
</p>
</li>
<li>
<p>
Tworzyć własne drogi routingu (routes) w klasycznym stylu hash lub popularnym obecnie RESTful
</p>
</li>
<li>
<p>
Rozpoznać jak droga routingu prowadzi do kontrolera i akcji.
</p>
</li>
</ul></div>
</div>
</div>
<h2 id="_podw_jny_cel_routingu">1. Podwójny cel routingu</h2>
<div class="sectionbody">
<div class="paragraph"><p>Routing w Railsach jest to dwukierunkowy mechanizm - tak, jakby móc przerobić
drzewa na papier, a potem z papieru z powrotem utworzyć drzewa. Dokładnie
rzecz biorąc, drogi routingu łączą nadchodzące żądania HTTP z kodem w
kontrolerach Twojej aplikacji i pomagają generować adresy URL bez konieczności
ręcznego zapisania ich jako łańcuchów znaków.</p></div>
<h3 id="_czenie_adresu_url_z_kodem">1.1. Łączenie adresu URL z kodem</h3>
<div class="paragraph"><p>Silnik routingu wewnątrz Railsów jest to fragment kodu, który przekazuje żądanie HTTP do odpowiedniego fragmentu aplikacji. Gdy Twoja aplikacja otrzymuje żądanie, np.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>GET /patients/17</tt></pre>
</div></div>
<div class="paragraph"><p>najprawdopodobniej wykona akcję <tt>show</tt> dla kontrolera <tt>patients</tt>, wyświetlając informacje o pacjencie posiadającym ID równe 17.</p></div>
<h3 id="_generowanie_adresu_url_z_kodu_r_d_owego">1.2. Generowanie adresu URL z kodu źródłowego</h3>
<div class="paragraph"><p>Routing działa także w drugą stronę. Załóżmy, że Twoja aplikacja zawiera kod:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">@patient</span> <span style="color: #990000">=</span> Patient<span style="color: #990000">.</span>find<span style="color: #990000">(</span><span style="color: #993399">17</span><span style="color: #990000">)</span>
<span style="color: #FF0000">&lt;%= link_to "Patient Record", patient_path(@patient) %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Mechanizm rutingu działa jako element tłumaczący ten kod na adres URL, np <tt>http://example.com/patients/17</tt>. Korzystając z routingu w ten sposób sprawisz, że Twoja aplikacja będzie bardziej niezawodna i łatwiejsza do zrozumienia niż w wypadku, gdybyś ręcznie wpisywał wszystkie linki URL.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Obiekt <tt>Patient</tt> musi być zadeklarowany jako zasób dostępny dla nazwanej drogi, by mógł zostać prawidłowo obsłużony przez ten kod.</td>
</tr></table>
</div>
</div>
<h2 id="_kr_tki_przegl_d_routes_rb">2. Krótki przegląd routes.rb</h2>
<div class="sectionbody">
<div class="paragraph"><p>Za routing w Railsach odpowiadają dwa moduły: silnik routingu, który jest integralną częścią frameworku oraz plik <tt>config/routes.rb</tt>, zawierający definicje dróg routingu używanych w aplikacji. Poznanie dokładnej zawartości pliku <tt>routes.rb</tt> jest podstawowym celem tego przewodnika. Zanim jednak zagłębimy się w tym temacie, proponuję krótki przegląd pliku.</p></div>
<h3 id="_przetwarzanie_pliku">2.1. Przetwarzanie pliku</h3>
<div class="paragraph"><p>Pod względem formatu, <tt>routes.rb</tt> jest po prostu dużym blokiem wysłanym do <tt>ActionController::Routing::Routes.draw</tt>. Wewnątrz tego bloku możesz umieszczać komentarze, jednak najprawdopodobniej większość jego zawartości to pojedyncze linie kodu - każda z nich odpowiada za drogę routingu w aplikacji. W pliku tym można znaleźć pięć podstawowych typów zawartości:</p></div>
<div class="ulist"><ul>
<li>
<p>
drogi RESTful
</p>
</li>
<li>
<p>
drogi nazwane
</p>
</li>
<li>
<p>
drogi zagnieżdżone
</p>
</li>
<li>
<p>
drogi regularne
</p>
</li>
<li>
<p>
drogi domyślne
</p>
</li>
</ul></div>
<div class="paragraph"><p>Każdą z nich omówimy dokładniej w dalszej części tego przewodnika.</p></div>
<div class="paragraph"><p>W momencie nadejścia żądania, plik <tt>routes.rb</tt> jest przetwarzany w kolejności "z góry na dół". W momencie odnalezienia pierwszego pasującego wpisu, żądanie zostaje przekazane przez powiązaną z nim drogę do odpowiedniego kontrolera. W przypadku, gdy w pliku nie będzie żadnej pasującej do żądania drogi routingu, Railsy zwrócą status 404.</p></div>
<h3 id="_drogi_restful">2.2. Drogi RESTful</h3>
<div class="paragraph"><p>Drogi RESTful korzystają z wbudowanej w Railsy orientacji REST, by umożliwić
zapisanie jak najwięcej informacji o routingu w jednej deklaracji. Ścieżka RESTful wygląda tak:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>books</tt></pre></div></div>
<h3 id="_drogi_nazwane">2.3. Drogi nazwane</h3>
<div class="paragraph"><p>Drogi nazwane dają bardzo czytelne linki w kodzie źródłowym. Poniżej przedstawiona została typowa droga nazwana:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>login <span style="color: #FF0000">'/login'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'sessions'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'new'</span></tt></pre></div></div>
<h3 id="_drogi_zagnie_d_one">2.4. Drogi zagnieżdżone</h3>
<div class="paragraph"><p>Drogi zagnieżdżone umożliwiają deklarację ścieżki do zasobu zawartego wewnątrz innego zasobu. Później zobaczysz jak taka droga umożliwia tłumaczenie kodu na adresy i ścieżki dostępu. Na przykład, jeśli aplikacja składa się z kilku części, a każda z nich należy do pewnej grupy, możesz stosować zagnieżdżoną drogę routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>assemblies <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>assemblies<span style="color: #990000">|</span>
  assemblies<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>parts
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<h3 id="_drogi_regularne">2.5. Drogi regularne</h3>
<div class="paragraph"><p>W wielu aplikacjach spotkasz się także z niezgodnym z założeniami REST routingiem, który wskazuje wprost powiązanie fragmentów URL z konkretną akcją. Przykład ścieżki regularnej to:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'parts/:number'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'inventory'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'show'</span></tt></pre></div></div>
<h3 id="_drogi_domy_lne">2.6. Drogi domyślne</h3>
<div class="paragraph"><p>Domyślne drogi routingu są siecią zabezpieczeń, obsługującą żądania które nie pasowały do żadnej innej drogi. Wiele aplikacji Railsowych zawiera taką parę ścieżek domyślnych:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id'</span>
map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id.:format'</span></tt></pre></div></div>
<div class="paragraph"><p>Te drogi routingu są automatycznie generowane podczas tworzenia nowej
aplikacji Railsowej. Jeśli cała Twoja aplikacja korzysta z routingu RESTful,
prawdopodobnie będziesz chciał je usunąć. Zanim jednak to zrobisz, upewnij
się, że nie są one faktycznie nigdy używane!</p></div>
</div>
<h2 id="_routing_restful_domy_lny_routing_rails_w">3. Routing RESTful: domyślny routing Railsów</h2>
<div class="sectionbody">
<div class="paragraph"><p>Routing RESTful jest obecnie standardowy w Railsach i to jego powinieneś preferować tworząc nowe aplikacje. Zrozumienie jak działa routing RESTful może wydawać się trochę trudne, jednak na pewno się opłaca; dzięki niemu Twój kod będzie dużo bardziej czytelny, a Twoja praca w końcu przestanie wyglądać jak walczenie z frameworkiem.</p></div>
<h3 id="_czym_jest_rest">3.1. Czym jest REST?</h3>
<div class="paragraph"><p>Założenia routingu REST pochodzą z pracy doktorskiej Roya Fieldinga: <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Architectural Styles and the Design of Network-based Software Architectures</a>. Na szczęście nie musisz czytać całego dokumentu, by zrozumieć ideę REST w Railsach. REST jest to skrót od angielskiej nazwy "Representational State Transfer", czyli Reprezentacyjny Transfer Stanu. Sprowadza się on do dwóch głównych założeń:</p></div>
<div class="ulist"><ul>
<li>
<p>
używanie identyfikatorów zasobów (dla celów tego przewodnika możesz je
  utożsamiać z adresami URL) do ich reprezentacji
</p>
</li>
<li>
<p>
transferowanie reprezentacji stanów każdego zasobu pomiędzy elementami systemu.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Na przykład, żądanie takie jak:</p></div>
<div class="paragraph"><p><tt>DELETE /photos/17</tt></p></div>
<div class="paragraph"><p>będzie odczytane przez aplikację railsową jako odniesienie do zasobu będącego
zdjęciem o ID równym 17, a akcją wymaganą przez takie żądanie będzie usunięcie
wskazanego zasobu. REST jest naturalnym stylem architektury aplikacji
sieciowej, a Railsy czynią go jeszcze bardziej przyjaznym dzięki konwencjom upraszczającym jego stosowanie.</p></div>
<h3 id="_crud_typy_da_i_akcje">3.2. CRUD, typy żądań i akcje</h3>
<div class="paragraph"><p>W Railsach, droga routingu RESTful łączy żądanie HTTP, akcję kontrolera i, pośrednio, operację CRUD na bazie danych. Pojedynczy wpis do pliku routingu, taki jak:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos</tt></pre></div></div>
<div class="paragraph"><p>tworzy siedem różnych dróg routingu w aplikacji:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<thead valign="top">
<tr>
<th align="left">żądanie HTTP </th>
<th align="left">URL             </th>
<th align="left">kontroler </th>
<th align="left">akcja    </th>
<th align="left">cel użycia</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">index</p></td>
<td align="left"><p class="table">wyświetlenie listy wszystkich zdjęć</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos/new</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">new</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do tworzenia zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">POST</p></td>
<td align="left"><p class="table">/photos</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">create</p></td>
<td align="left"><p class="table">tworzenie nowego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos/1</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">show</p></td>
<td align="left"><p class="table">wyświetlenie konkretnego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos/1/edit</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">edit</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do edycji zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">PUT</p></td>
<td align="left"><p class="table">/photos/1</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">update</p></td>
<td align="left"><p class="table">aktualizacja konkretnego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">DELETE</p></td>
<td align="left"><p class="table">/photos/1</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">destroy</p></td>
<td align="left"><p class="table">usunięcie konkretnego zdjęcia</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Dla dróg routingu odnoszących się do jednego konkretnego zasobu, identyfikator zasobu będzie dostępny dla akcji odpowiedniego kontrolera jako parametr <tt>params[:id]</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeśli stale używasz dróg RESTful, powinieneś wyłączyć drogi domyślne w pliku <tt>routes.rb</tt>, aby Railsy wymusiły routowanie oparte na typach żądań.</td>
</tr></table>
</div>
<h3 id="_adresy_url_i_cie_ki_dost_pu">3.3. Adresy URL i ścieżki dostępu</h3>
<div class="paragraph"><p>Stworzenie drogi routingu RESTful powoduje także udostępnienie kilku helperów wewnątrz aplikacji:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>photos_url</tt> i <tt>photos_path</tt> wskazują ścieżki dostępu do akcji <tt>index</tt> i <tt>create</tt>
</p>
</li>
<li>
<p>
<tt>new_photo_url</tt> i <tt>new_photo_path</tt> wskazują ścieżkę dostępu do akcji <tt>new</tt>
</p>
</li>
<li>
<p>
<tt>edit_photo_url</tt> i <tt>edit_photo_path</tt> wskazują ścieżkę dostępu do akcji <tt>edit</tt>
</p>
</li>
<li>
<p>
<tt>photo_url</tt>  i <tt>photo_path</tt> wskazują ścieżki dostępu do akcji <tt>show</tt>, <tt>update</tt> i <tt>destroy</tt>
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Ponieważ routing opiera się zarówno na typach żądań HTTP jak i na ścieżkach dostępu w nich zawartych, siedem dróg routingu wymaga określenia tylko czterech par helperów.</td>
</tr></table>
</div>
<div class="paragraph"><p>W każdym przypadku, helper <tt>_url</tt> generuje łańcuch znaków zawierający pełny adres URL jaki będzie zrozumiały dla aplikacji, a <tt>_path</tt> - łańcuch zawierający ścieżkę dostępu odnoszącą się do katalogu głównego aplikacji. Na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>photos_url  <span style="font-style: italic"><span style="color: #9A1900"># =&gt; "http://www.example.com/photos"</span></span>
photos_path <span style="font-style: italic"><span style="color: #9A1900"># =&gt; "/photos"</span></span></tt></pre></div></div>
<h3 id="_definiowanie_kilku_zasob_w_jednocze_nie">3.4. Definiowanie kilku zasobów jednocześnie</h3>
<div class="paragraph"><p>Jeśli chcesz utworzyć drogi routingu do więcej niż jednego zasobu RESTful, możesz zaoszczędzić dużo kodu definiując je wewnątrz jednego odwołania do <tt>map.resources</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>books<span style="color: #990000">,</span> <span style="color: #990000">:</span>videos</tt></pre></div></div>
<div class="paragraph"><p>Taki zapis jest równoważny z poniższym:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos
map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>books
map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>videos</tt></pre></div></div>
<h3 id="_pojedyncze_zasoby">3.5. Pojedyncze zasoby</h3>
<div class="paragraph"><p>Możesz także zastosować routing RESTful do pojedynczego zasobu wewnątrz aplikacji. W tym przypadku zamiast <tt>map.resources</tt>, użyj <tt>map.resource</tt>, a generowane drogi routingu będą troszkę inne. Na przykład, wpis routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resource <span style="color: #990000">:</span>geocoder</tt></pre></div></div>
<div class="paragraph"><p>stworzy sześć dróg routingu w aplikacji:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<thead valign="top">
<tr>
<th align="left">żądanie HTTP </th>
<th align="left">URL             </th>
<th align="left">kontroler </th>
<th align="left">akcja    </th>
<th align="left">cel użycia</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/geocoder/new</p></td>
<td align="left"><p class="table">Geocoders</p></td>
<td align="left"><p class="table">new</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do tworzenia geokodera</p></td>
</tr>
<tr>
<td align="left"><p class="table">POST</p></td>
<td align="left"><p class="table">/geocoder</p></td>
<td align="left"><p class="table">Geocoders</p></td>
<td align="left"><p class="table">create</p></td>
<td align="left"><p class="table">tworzenie nowego geokodera</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/geocoder</p></td>
<td align="left"><p class="table">Geocoders</p></td>
<td align="left"><p class="table">show</p></td>
<td align="left"><p class="table">wyświetlenie jednego jedynego geokodera</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/geocoder/edit</p></td>
<td align="left"><p class="table">Geocoders</p></td>
<td align="left"><p class="table">edit</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do edycji geokodera</p></td>
</tr>
<tr>
<td align="left"><p class="table">PUT</p></td>
<td align="left"><p class="table">/geocoder</p></td>
<td align="left"><p class="table">Geocoders</p></td>
<td align="left"><p class="table">update</p></td>
<td align="left"><p class="table">akrualizacja geokodera</p></td>
</tr>
<tr>
<td align="left"><p class="table">DELETE</p></td>
<td align="left"><p class="table">/geocoder</p></td>
<td align="left"><p class="table">Geocoders</p></td>
<td align="left"><p class="table">destroy</p></td>
<td align="left"><p class="table">usunięcie geokodera</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Pomimo, ze nazwa zasobu jest w liczbie pojedynczej, (Geocoder), odpowiadający za nią kontroler ma nazwę w liczbie mnogiej (Geocoders).</td>
</tr></table>
</div>
<div class="paragraph"><p>Pojedyncza ścieżka routingu RESTful generuje zmniejszony zestaw helperów:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>new_geocoder_url</tt> i <tt>new_geocoder_path</tt> wskazują ścieżkę dostępu do akcji <tt>new</tt>
</p>
</li>
<li>
<p>
<tt>edit_geocoder_url</tt> i <tt>edit_geocoder_path</tt> wskazują ścieżkę dostępu do akcji <tt>edit</tt>
</p>
</li>
<li>
<p>
<tt>geocoder_url</tt> i <tt>geocoder_path</tt> wskazują ścieżki dostępu do akcji <tt>create</tt>, <tt>show</tt>, <tt>update</tt> i <tt>destroy</tt>
</p>
</li>
</ul></div>
<h3 id="_dopasowanie_zasob_w">3.6. Dopasowanie zasobów</h3>
<div class="paragraph"><p>Chociaż konwencje routingu RESTful są wystarczające dla większości aplikacji, można jednak dopasować do własnych potrzeb wiele aspektów jego działania. Służą do tego następujące opcje:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>:controller</tt>
</p>
</li>
<li>
<p>
<tt>:singular</tt>
</p>
</li>
<li>
<p>
<tt>:requirements</tt>
</p>
</li>
<li>
<p>
<tt>:conditions</tt>
</p>
</li>
<li>
<p>
<tt>:as</tt>
</p>
</li>
<li>
<p>
<tt>:path_names</tt>
</p>
</li>
<li>
<p>
<tt>:path_prefix</tt>
</p>
</li>
<li>
<p>
<tt>:name_prefix</tt>
</p>
</li>
<li>
<p>
<tt>:only</tt>
</p>
</li>
<li>
<p>
<tt>:except</tt>
</p>
</li>
</ul></div>
<div class="paragraph"><p>Możesz także tworzyć dodatkowe drogi routingu przy pomocy opcji <tt>:member</tt> i <tt>:collection</tt>, które zostaną omówione w dalszej części tego przewodnika.</p></div>
<h4 id="_u_ycie_controller">3.6.1. Użycie :controller</h4>
<div class="paragraph"><p>Opcja <tt>:controller</tt> pozwala użyć kontrolera o innej nazwie niż dostępna od zewnątrz nazwa zasobu. Na przykład, wpis:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"images"</span></tt></pre></div></div>
<div class="paragraph"><p>rozpozna przychodzące żądania zawierające <tt>photo</tt>, lecz skieruje je do kontrolera <tt>Images</tt>:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<thead valign="top">
<tr>
<th align="left">żądanie HTTP </th>
<th align="left">URL             </th>
<th align="left">kontroler </th>
<th align="left">akcja    </th>
<th align="left">cel użycia</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">index</p></td>
<td align="left"><p class="table">wyświetlenie listy wszystkich zdjęć</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos/new</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">new</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do tworzenia zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">POST</p></td>
<td align="left"><p class="table">/photos</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">create</p></td>
<td align="left"><p class="table">tworzenie nowego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos/1</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">show</p></td>
<td align="left"><p class="table">wyświetlenie konkretnego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/photos/1/edit</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">edit</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do edycji zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">PUT</p></td>
<td align="left"><p class="table">/photos/1</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">update</p></td>
<td align="left"><p class="table">aktualizacja konkretnego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">DELETE</p></td>
<td align="left"><p class="table">/photos/1</p></td>
<td align="left"><p class="table">Images</p></td>
<td align="left"><p class="table">destroy</p></td>
<td align="left"><p class="table">usunięcie konkretnego zdjęcia</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Wygenerowane helpery będą zawierały nazwę zasobu, a nie kontrolera. W powyższym przykładzie nadal otrzymamy helpery takie jak <tt>photos_path</tt>, <tt>new_photo_path</tt> itd.</td>
</tr></table>
</div>
<h3 id="_routing_a_przestrzenie_nazw_kontroler_w">3.7. Routing a przestrzenie nazw kontrolerów</h3>
<div class="paragraph"><p>Railsy pozwalają na grupowanie kontrolerów w przestrzenie nazw (namespaces) poprzez umieszczenie ich w podfolderach <tt>app/controllers</tt>. Opcja <tt>:controller</tt> umożliwia wygodny routing do takich kontrolerów. Na przykład, możesz posiadać zasób, którego kontroler służy jedynie do celów administracyjnych, umieszczony w podkatalogu <tt>admin</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>adminphotos<span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"admin/photos"</span></tt></pre></div></div>
<div class="paragraph"><p>Jeśli grupujesz w ten sposób kontrolery, zwróc uwagę na pewien niuans routingu: Railsy zawsze starają się znaleźć zasób najbardziej zbliżony do tego, którego użyły w poprzednim żądaniu. Na przykład, jeśli oglądasz obecnie widok wygenerowany przez helper <tt>adminphoto_path</tt> i klikniesz w link wygenerowany kodem <tt>&lt;%= link_to "show", adminphoto(1) %&gt;</tt>, zostaniesz przekierowany do widoku wygenerowanego przez <tt>admin/photos/show</tt>, ale w to samo miejsce przekieruje Cię także link <tt>&lt;%= link_to "show", {:controller =&gt; "photos", :action =&gt; "show"} %&gt;</tt>, ponieważ Railsy wygenerują URL nawiązujący do obecnego adresu URL.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Aby zapewnić, że link wskazuje na kontroler najwyższego poziomu, poprzedź nazwę kontrolera ukośnikiem: <tt>&lt;%= link_to "show", {:controller =&gt; "/photos", :action =&gt; "show"} %&gt;</tt></td>
</tr></table>
</div>
<div class="paragraph"><p>Możesz także określić przestrzeń nazw kontrolera używając opcji <tt>:namespace</tt> zamiast podawać ścieżkę dostępu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>adminphotos<span style="color: #990000">,</span> <span style="color: #990000">:</span>namespace <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"admin"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span></tt></pre></div></div>
<div class="paragraph"><p>Może to być szczególnie przydatne, jeśli połączymy to zastosowanie z <tt>with_options</tt> w celu połączenia kilku dróg routingu naraz:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>with_options<span style="color: #990000">(:</span>namespace <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"admin"</span><span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>admin<span style="color: #990000">|</span>
  admin<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>videos
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Taki zapis zapewni routing dla kontrolerów <tt>admin/photos</tt> i <tt>admin/videos</tt>.</p></div>
<h4 id="_u_ycie_singular">3.7.1. Użycie :singular</h4>
<div class="paragraph"><p>Jeśli z jakiegoś powodu Railsy nie radzą sobie prawidłowo z utworzeniem nazwy pojedynczej pochodzącej od nazwy w liczbie mnogiej, możesz wymusić zmianę tej nazwy korzystając z opcji <tt>:singular</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>teeth<span style="color: #990000">,</span> <span style="color: #990000">:</span>singular <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"tooth"</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">W zależności od reszty aplikacji, możesz zamiast tego stworzyć dodatkowe reguły dla klasy <tt>Inflector</tt>.</td>
</tr></table>
</div>
<h4 id="_u_ycie_requirements">3.7.2. Użycie :requirements</h4>
<div class="paragraph"><p>Możesz użyć opcji <tt>:requirements</tt> w drodze routingu RESTful, by wymusić odpowiednie formatowanie parametru <tt>:id</tt> w pojedynczych ścieżkach routingu. Na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>requirements <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span><span style="color: #990000">:</span>id <span style="color: #990000">=&gt;</span> <span style="color: #FF6600">/[A-Z][A-Z][0-9]+/</span><span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Ta deklaracja spowoduje, że parametr <tt>:id</tt> będzie musiał być zgodny z podanym wyrażeniem regularnym. W tym przypadku, żądanie <tt>/photos/1</tt> nie będzie dłużej pasowało do tej drogi routingu, ale np. <tt>photos/RR27</tt> będzie.</p></div>
<h4 id="_u_ycie_conditions">3.7.3. Użycie :conditions</h4>
<div class="paragraph"><p>Ten parametr jest obecnie używany tylko dla ustawienia typu żądań HTTP dotyczących indywidualnych ścieżek routingu. W teorii możesz ustawić go dla ścieżek RESTful, ale w praktyce nie ma to większego sensu. (Więcej o warunku <tt>:conditions</tt> dowiesz się z rozdziału dotyczącego klasycznego routingu w tym przewodniku.)</p></div>
<h4 id="_u_ycie_as">3.7.4. Użycie :as</h4>
<div class="paragraph"><p>Opcja <tt>:as</tt> pozwala nadpisać domyślną nazwę dla tworzonych ścieżek dostępu. Przykładowo, wpis:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>as <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"images"</span></tt></pre></div></div>
<div class="paragraph"><p>rozpozna nadchodzące żądanie zawierające w URL słowo <tt>image</tt>, ale ścieżka routingu skieruje je do kontrolera Photos:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<thead valign="top">
<tr>
<th align="left">żądanie HTTP </th>
<th align="left">URL             </th>
<th align="left">kontroler </th>
<th align="left">akcja    </th>
<th align="left">cel użycia</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/images</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">index</p></td>
<td align="left"><p class="table">wyświetlenie listy wszystkich zdjęć</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/images/new</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">new</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do tworzenia zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">POST</p></td>
<td align="left"><p class="table">/images</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">create</p></td>
<td align="left"><p class="table">tworzenie nowego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/images/1</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">show</p></td>
<td align="left"><p class="table">wyświetlenie konkretnego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/images/1/edit</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">edit</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do edycji zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">PUT</p></td>
<td align="left"><p class="table">/images/1</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">update</p></td>
<td align="left"><p class="table">aktualizacja konkretnego zdjęcia</p></td>
</tr>
<tr>
<td align="left"><p class="table">DELETE</p></td>
<td align="left"><p class="table">/images/1</p></td>
<td align="left"><p class="table">Photos</p></td>
<td align="left"><p class="table">destroy</p></td>
<td align="left"><p class="table">usunięcie konkretnego zdjęcia</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Wygenerowane helpery będą zawierały nazwę zasobu, a nie ścieżki dostępu. W powyższym przykładzie nadal otrzymamy helpery takie jak <tt>photos_path</tt>, <tt>new_photo_path</tt> itd.</td>
</tr></table>
</div>
<h4 id="_u_ycie_path_names">3.7.5. Użycie :path_names</h4>
<div class="paragraph"><p>Opcja <tt>:path_names</tt> pozwala nadpisać domyślne elementy <tt>new</tt> i <tt>edit</tt> w adresie URL:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>path_names <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>new <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'make'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>edit <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'change'</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Taki zapis spowoduje, że routing Railsów rozpozna URL takie jak:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>/photos/make
/photos/1/change</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Rzeczywista nazwa akcji nie ulegnie zmianie; drogi routingu nadal będą prowadziły do akcji <tt>new</tt> i <tt>edit</tt>.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeśli zechcesz zmienić tą opcją wszystkie drogi, możesz ustawić ją jako domyślną dla środowiska:</td>
</tr></table>
</div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>config<span style="color: #990000">.</span>action_controller<span style="color: #990000">.</span>resources_path_names <span style="color: #990000">=</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>new <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'make'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>edit <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'change'</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
<h4 id="_u_ycie_path_prefix">3.7.6. Użycie :path_prefix</h4>
<div class="paragraph"><p>Opcja <tt>:path_prefix</tt> pozwala umieścić dodatkowe parametry, by były zawarte w prefiksie pasującej ścieżki dostępu. Załóżmy na przykład, że każde zdjęcie zawarte w aplikacji jest przypisane do konkretnego autora. W tej sytuacji, możesz zadeklarować następującą ścieżkę routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>path_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'/photographers/:photographer_id'</span></tt></pre></div></div>
<div class="paragraph"><p>Do ścieżek pasujących do tego wpisu będą należały między innymi:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>/photographers/1/photos/2
/photographers/1/photos</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">W większości przypadków, łatwiej jest rozpoznawać takie URL poprzez stworzenie zagnieżdżonych zasobów, jak zostało to opisane w następnym rozdziale.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Możesz też użyć opcji <tt>:path_prefix</tt> dla dróg routingu innych niż RESTful.</td>
</tr></table>
</div>
<h4 id="_u_ycie_name_prefix">3.7.7. Użycie :name_prefix</h4>
<div class="paragraph"><p>Możesz użyć opcji <tt>name_prefix</tt> by zapobiec kolizji wpisów. Funkcja staje się bardzo użyteczna, gdy masz dwa zasoby o tej samej nazwie, które dzięki użyciu <tt>:path_prefix</tt> będą routowane inaczej. Na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>path_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'/photographers/:photographer_id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>name_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photographer_'</span>
map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>path_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'/agencies/:agency_id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>name_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'agency_'</span></tt></pre></div></div>
<div class="paragraph"><p>Taka kombinacja utworzy helpery takie jak <tt>photographer_photos_path</tt> i <tt>agency_edit_photo_path</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Możesz też użyć opcji <tt>:name_prefix</tt> dla dróg routingu innych niż RESTful.</td>
</tr></table>
</div>
<h4 id="_u_ycie_only_i_except">3.7.8. Użycie :only i :except</h4>
<div class="paragraph"><p>Railsy tworzą drogi routingu dla wszystkich siedmiu domyślnych akcji (<tt>index</tt>, <tt>show</tt>, <tt>new</tt>, <tt>create</tt>, <tt>edit</tt>, <tt>update</tt> i <tt>destroy</tt>) dla każdej drogi RESTful. Możesz użyć opcji <tt>:only</tt> i <tt>:except</tt>, by dopasować to zachowanie. Opcja <tt>:only</tt> wymusza wykonanie tylko wskazanych ścieżek routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>only <span style="color: #990000">=&gt;</span> <span style="color: #990000">[:</span>index<span style="color: #990000">,</span> <span style="color: #990000">:</span>show<span style="color: #990000">]</span></tt></pre></div></div>
<div class="paragraph"><p>Przy takim wpisie, żądanie <tt>GET</tt> odnoszące się do zasobu <tt>/photos</tt> zostanie obsłużone, ale żądanie <tt>POST</tt> dla <tt>/photos</tt> (normalnie wskazujące na akcję <tt>create</tt>) już nie.</p></div>
<div class="paragraph"><p>Opcja <tt>:except</tt> jest odwrotnością <tt>:only</tt> - wskazuje ona na akcje, które <em>nie
zostaną obsłużone</em> przez wpis:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>except <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>destroy</tt></pre></div></div>
<div class="paragraph"><p>W tym przypadku, zostaną utworzone wszystkie normalne drogi routingu oprócz tej obsługującej akcję <tt>destroy</tt> (żądanie <tt>DELETE</tt> odnoszące się do zasobu <tt>photos/<em>id</em></tt>).</p></div>
<div class="paragraph"><p>Poza nazwami akcji, możesz także użyć dla opcji <tt>:only</tt> i <tt>:except</tt> specjalnych symboli, takich jak: <tt>:all</tt> i <tt>:none</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeśli w aplikacji występuje dużo dróg RESTful, użycie opcji <tt>:only</tt> i <tt>:except</tt>, by wygenerować tylko potrzebne ścieżki, może znacząco obniżyć zużycie pamięci i przyspieszyć proces routingu.</td>
</tr></table>
</div>
<h3 id="_zasoby_zagnie_d_one">3.8. Zasoby zagnieżdżone</h3>
<div class="paragraph"><p>Częstym przypadkiem są zasoby logicznie przypisane do innych zasobów. Załóżmy na przykład, że aplikacja zawiera modele:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Magazine <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
  has_many <span style="color: #990000">:</span>ads
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Ad <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
  belongs_to <span style="color: #990000">:</span>magazine
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Każdy obiekt <tt>ad</tt> logicznie służy do obsługi jednego obiektu <tt>magazine</tt>. Drogi zagnieżdżone pozwalają zachować tę zależność podczas routingu. W tym przypadku, możesz użyć następującej deklaracji routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>magazines <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>magazine<span style="color: #990000">|</span>
  magazine<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>ads
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Poza drogami routingu do obiektów <tt>magazine</tt>, ta deklaracja stworzy także drogi do obiektów <tt>ad</tt>. Każda z nich będzie wymagała określenia w URL do którego obiektu <tt>magazine</tt> się odnosi:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<thead valign="top">
<tr>
<th align="left">żądanie HTTP </th>
<th align="left">URL                      </th>
<th align="left">kontroler </th>
<th align="left">akcja    </th>
<th align="left">cel użycia</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/magazines/1/ads</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">index</p></td>
<td align="left"><p class="table">wyświetlenie listy wszystkich <tt>ad</tt> dla wskazanego obiektu <tt>magazine</tt></p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/magazines/1/ads/new</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">new</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do tworzenia obiektu <tt>ad</tt> należącego do wskazanego obiektu <tt>magazine</tt></p></td>
</tr>
<tr>
<td align="left"><p class="table">POST</p></td>
<td align="left"><p class="table">/magazines/1/ads</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">create</p></td>
<td align="left"><p class="table">tworzenie nowego obiektu <tt>ad</tt> należącego do wskazanego obiektu <tt>magazine</tt></p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/magazines/1/ads/1</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">show</p></td>
<td align="left"><p class="table">wyświetlenie konkretnego obiektu <tt>ad</tt> należącego do wskazanego obiektu <tt>magazine</tt></p></td>
</tr>
<tr>
<td align="left"><p class="table">GET</p></td>
<td align="left"><p class="table">/magazines/1/ads/1/edit</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">edit</p></td>
<td align="left"><p class="table">zwrócenie formularza HTML do edycji obiektu <tt>ad</tt> należącego do wskazanego obiekty <tt>magazine</tt></p></td>
</tr>
<tr>
<td align="left"><p class="table">PUT</p></td>
<td align="left"><p class="table">/magazines/1/ads/1</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">update</p></td>
<td align="left"><p class="table">aktualizacja konkretnego obiektu <tt>ad</tt> należącego do wskazanego obiektu <tt>magazine</tt></p></td>
</tr>
<tr>
<td align="left"><p class="table">DELETE</p></td>
<td align="left"><p class="table">/magazines/1/ads/1</p></td>
<td align="left"><p class="table">Ads</p></td>
<td align="left"><p class="table">destroy</p></td>
<td align="left"><p class="table">usunięcie konkretnego obiektu <tt>ad</tt> należącego do wskazanego obiektu <tt>magazine</tt></p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Wpis ten stworzy także helpery, takie jak <tt>magazine_ads_url</tt> i <tt>edit_magazine_ad_path</tt>.</p></div>
<h4 id="_u_ycie_name_prefix_2">3.8.1. Użycie :name_prefix</h4>
<div class="paragraph"><p>Opcja <tt>:name_prefix</tt> nadpisuje automatycznie generowany prefiks w helperach dla zagnieżdżonych ścieżek routingu, na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>magazines <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>magazine<span style="color: #990000">|</span>
  magazine<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>ads<span style="color: #990000">,</span> <span style="color: #990000">:</span>name_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'periodical'</span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Stworzy to helpery takie jak <tt>periodical_ads_url</tt> i <tt>periodical_edit_ad_path</tt>. Możesz nawet użyć <tt>:name_prefix</tt> by całkowicie usunąć prefiksy:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>magazines <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>magazine<span style="color: #990000">|</span>
  magazine<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>ads<span style="color: #990000">,</span> <span style="color: #990000">:</span>name_prefix <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #0000FF">nil</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Spowoduje to utworzenie helperów <tt>ads_url</tt> i <tt>edit_ad_path</tt>. Zwróć uwagę na fakt, że dodanie identyfikatora nadal będzie wymagane przy użyciu helperów:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>ads_url<span style="color: #990000">(</span><span style="color: #009900">@magazine</span><span style="color: #990000">)</span>
edit_ad_path<span style="color: #990000">(</span><span style="color: #009900">@magazine</span><span style="color: #990000">,</span> <span style="color: #009900">@ad</span><span style="color: #990000">)</span></tt></pre></div></div>
<h4 id="_u_ycie_has_one_i_has_many">3.8.2. Użycie :has_one i :has_many</h4>
<div class="paragraph"><p>Opcje <tt>:has_one</tt> i <tt>:has_many</tt> umożliwiają zwięzłą notację prostych dróg zagnieżdżonych. Używamy <tt>:has_one</tt> dla zagnieżdżenia pojedynczego zasobu lub <tt>:has_many</tt> dla wielu zasobów:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>has_one <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>photographer<span style="color: #990000">,</span> <span style="color: #990000">:</span>has_many <span style="color: #990000">=&gt;</span> <span style="color: #990000">[:</span>publications<span style="color: #990000">,</span> <span style="color: #990000">:</span>versions<span style="color: #990000">]</span></tt></pre></div></div>
<div class="paragraph"><p>Spowoduje to ten sam efekt co wpisanie całego zestawu deklaracji:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>photo<span style="color: #990000">|</span>
  photo<span style="color: #990000">.</span>resource <span style="color: #990000">:</span>photographer
  photo<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>publications
  photo<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>versions
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<h4 id="_ograniczenia_zagnie_d_enia">3.8.3. Ograniczenia zagnieżdżenia</h4>
<div class="paragraph"><p>Możesz zagnieździć zasoby wewnątrz innych zagnieżdżonych zasobów. Na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>publishers <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>publisher<span style="color: #990000">|</span>
  publisher<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>magazines <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>magazine<span style="color: #990000">|</span>
    magazine<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Jeśli jednak nie użyjesz opcji <tt>name_prefix =&gt; nil</tt>, wielokrotnie zagnieżdżone zasoby staną się bardzo niewygodne w użyciu. Dla tego przykładu, aplikacja poprawnie obsługiwałaby URL takie jak:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>/publishers/1/magazines/2/photos/3</tt></pre>
</div></div>
<div class="paragraph"><p>Odpowiedni helper miałby postać <tt>publisher_magazine_photo_url</tt>, co wymagałoby określania trzech poziomów obiektów. W praktyce jest to na tyle niewygodne i mylące rozwiązanie, że popularny <a href="link:http://weblog.jamisbuck.org/2007/2/5/nesting-resources">artykuł</a> autorstwa Jamisa Bucka wprowadza regułę szeroko stosowaną przy projektowaniu z wykorzystaniem frameworku Rails:</p></div>
<div class="paragraph"><p><em>Zasoby nie powinny być nigdy zagnieżdżone na więcej niż jednym poziomie.</em></p></div>
<h4 id="_p_ytkie_zagnie_d_enie">3.8.4. Płytkie zagnieżdżenie</h4>
<div class="paragraph"><p>Opcja <tt>:shallow</tt> oferuje eleganckie rozwiązanie problemów z głęboko zagnieżdżonymi drogami routingu. Jeśli użyjesz jej na dowolnym poziomie routingu, ścieżki dostępu do zagnieżdżonych zasobów odnoszące się do konkretnego elementu (tzn. takiego, który posiada parametr <tt>:id</tt>) nie będą posiadały obiektu nadrzędnego w prefiksie. Aby lepiej to wyjaśnić posłużę się przykładem:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>publishers<span style="color: #990000">,</span> <span style="color: #990000">:</span>shallow <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #0000FF">true</span></span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>publisher<span style="color: #990000">|</span>
  publisher<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>magazines <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>magazine<span style="color: #990000">|</span>
    magazine<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Ten wpis umożliwi rozpoznanie m.in. takich dróg routingu:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>/publishers/1           ==&gt; publisher_path(1)
/publishers/1/magazines ==&gt; publisher_magazines_path(1)
/magazines/2            ==&gt; magazine_path(2)
/magazines/2/photos     ==&gt; magazines_photos_path(2)
/photos/3               ==&gt; photo_path(3)</tt></pre>
</div></div>
<div class="paragraph"><p>Przy płytkim zagnieżdżeniu, wystarczy podać minimalną liczbę informacji potrzebną do jednoznaczej identyfikacji zasobu, by móc na nim pracować. Jeśli chcesz, możesz łączyć płytkie zagnieżdżenie z opcjami <tt>:has_one</tt> i <tt>:has_many</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>publishers<span style="color: #990000">,</span> <span style="color: #990000">:</span>has_many <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>magazines <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>photos <span style="color: #FF0000">}</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>shallow <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #0000FF">true</span></span></tt></pre></div></div>
<h3 id="_generowanie_drogi_routingu_z_tablic">3.9. Generowanie drogi routingu z tablic</h3>
<div class="paragraph"><p>Oprócz helperów routingu, Railsy mogą też generować drogi RESTful z tablicy parametrów. Załóżmy na przykład, że masz zestaw dróg routingu wygenerowanych na podstawie następujących wpisów w pliku routes.rb:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>magazines <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>magazine<span style="color: #990000">|</span>
  magazine<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>ads
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Railsy wygenerują helpery takie jak <tt>magazine_ad_path</tt>, które mogą służyć do tworzenia linków:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;%= link_to "Ad details", magazine_ad_path(@magazine, @ad) %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Inny sposobem odniesienia się do tej drogi routingu jest tablica obiektów:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;%= link_to "Ad details", [@magazine, @ad] %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Ten format jest bardzo wygodny, gdy nie wiesz z góry jaki typów obiektu będzie użyty w danym linku.</p></div>
<h3 id="_zasoby_z_przestrzeni_nazw">3.10. Zasoby z przestrzenią nazw</h3>
<div class="paragraph"><p>Łącząc opcje <tt>:path_prefix</tt> i <tt>:name_prefix</tt> możesz osiągnąć dosyć skomplikowane struktury. Na przykład, możesz użyć takiej kombinacji by przenieść zasoby administracyjne do oddzielnego katalogu w aplikacji:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>path_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin/photos'</span>
map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>tags<span style="color: #990000">,</span> <span style="color: #990000">:</span>name_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin_photo_'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>path_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin/photos/:photo_id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin/photo_tags'</span>
map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>ratings<span style="color: #990000">,</span> <span style="color: #990000">:</span>name_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin_photo_'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>path_prefix <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin/photos/:photo_id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'admin/photo_ratings'</span></tt></pre></div></div>
<div class="paragraph"><p>Dobrą wiadomością jest, że jeśli Twój kod okaże się zbyt rozbudowany, możesz go uprościć. Railsy umożliwiają dzielenie zasobów na <em>przestrzenie nazw</em>, aby ułatwić ich rozmieszczenie we własnych katalogach. Oto te same trzy drogi routingu stworzone z wykorzystaniem przestrzeni nazw:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>namespace<span style="color: #990000">(:</span>admin<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>admin<span style="color: #990000">|</span>
        admin<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span>
          <span style="color: #990000">:</span>has_many <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>tags<span style="color: #990000">,</span> <span style="color: #990000">:</span>ratings<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Jak widzisz, taka wersja jest znacznie zwięźlejsza, a mimo tego daje takie same efekty. Uzyskasz te same helpery, np. <tt>admin_photos_url</tt>, korzystający z kontrolera <tt>Admin::PhotosController</tt> i wskazujący na <tt>admin/photos</tt> oraz <tt>admin_photos_ratings_path</tt>, wskazujący na <tt>admin/photos/<em>photo_id</em>/ratings</tt> i korzystający z <tt>Admin::RatingsController</tt>. Nawet jeśli nie zdefiniujesz bezpośrednio prefiksu <tt>path_prefix</tt>, wpis routingu spowoduje automatycznie wyliczenie poprawnego prefiksu dla drogi zagnieżdżonej.</p></div>
<h3 id="_dodawanie_wi_kszej_liczby_akcji_restful">3.11. Dodawanie większej liczby akcji RESTful</h3>
<div class="paragraph"><p>Nie jesteś ograniczony do siedmiu domyślnie tworzonych dróg routingu. Jeśli
chcesz możesz dodawać kolejne drogi członkowskie (<em>member routes</em>; odnoszące się do konkretnego zasobu), a także drogi tworzące zasoby oraz drogi odnoszące się do zestawu zasobów jako całości.</p></div>
<h4 id="_dodawanie_dr_g_cz_onkowskich">3.11.1. Dodawanie dróg członkowskich</h4>
<div class="paragraph"><p>Aby dodać drogę członkowską, użyj opcji <tt>:member</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>member <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>preview <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>get <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Umożliwi to Railsom rozpoznanie adresów URL takich jak <tt>/photos/1/preview</tt> przy żądaniu HTTP GET i przekazanie ich do akcji <tt>preview</tt> kontrolera <tt>Photos</tt>. Stworzy to także helper <tt>preview_photo</tt>.</p></div>
<div class="paragraph"><p>Wewnątrz tablicy dróg członkowskich, każda z nich określa typ żądania HTTP,
jaki będzie rozpoznawać. Do dyspozycji mamy <tt>:get</tt>, <tt>:put</tt>, <tt>:post</tt>, <tt>:delete</tt> lub <tt>:any</tt>. Możesz także określić tablicę metod, jeśli potrzebujesz więcej niż jedną, ale nie chcesz dopuścić dowolnej:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>member <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>prepare <span style="color: #990000">=&gt;</span> <span style="color: #990000">[:</span>get<span style="color: #990000">,</span> <span style="color: #990000">:</span>post<span style="color: #990000">]</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
<h4 id="_dodawanie_dr_g_do_zestawu_zasob_w">3.11.2. Dodawanie dróg do zestawu zasobów</h4>
<div class="paragraph"><p>Aby dodać drogę odnoszącą się do zestawu zasobów jako całości, wykorzystywana jest opcja <tt>:collection</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>collection <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>search <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>get <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Taki wpis pozwoli Railsom rozpoznać URL taki jak <tt>/photos/search</tt> wykorzystujący żądanie HTTP GET i skierować go do akcji <tt>search</tt> kontrolera <tt>Photos</tt>. Dodatkowo, stworzony zostanie helper <tt>search_photos</tt>.</p></div>
<div class="paragraph"><p>Tak jak przy drogach członkowskich, możesz określić tablicę metod dostępnych dla drogi do zestawu zasobów:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>collection <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>search <span style="color: #990000">=&gt;</span> <span style="color: #990000">[:</span>get<span style="color: #990000">,</span> <span style="color: #990000">:</span>post<span style="color: #990000">]</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
<h4 id="_dodawanie_dr_g_tworz_cych_zasoby">3.11.3. Dodawanie dróg tworzących zasoby</h4>
<div class="paragraph"><p>Aby dodać nową drogę tworzącą zasoby, używamy opcji <tt>:new</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>new <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>upload <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>post <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Taki wpis sprawi, że Railsy rozpoznają URL-e takie jak <tt>/photos/upload</tt> wykorzystujące żądanie HTTP POST i skieruje je do akcji <tt>upload</tt> kontrolera <tt>Photos</tt>. Stworzony zostanie także helper <tt>upload_photos</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeśli chcesz przedefiniować typ żądania akceptowanego przez jedną ze standardowych akcji, możesz to zrobić wprost poprzez wskazanie tej akcji, np:</td>
</tr></table>
</div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>photos<span style="color: #990000">,</span> <span style="color: #990000">:</span>new <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>new <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>any <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Dzięki temu akcja <tt>new</tt> będzie mogła być wywołana przez żądanie odnoszące się do <tt>photos/new</tt>, niezależnie od typu tego żądania.</p></div>
<h4 id="_uwaga_ko_cowa">3.11.4. Uwaga końcowa</h4>
<div class="paragraph"><p>Jeśli okaże się, że tworzysz zbyt wiele dodatkowych akcji dla drogi RESTful, czas zastanowić się dlaczego nie chcesz uznać potrzeby stworzenia nowego zasobu, który mógłby przejąć te żądania. W momencie, gdy kolejne opcje <tt>:member</tt> i <tt>:collection</tt> zaczynają tworzyć wielkie śmietnisko, routing RESTful traci swoją najważniejszą zaletę, jaką jest czytelność kodu.</p></div>
</div>
<h2 id="_drogi_regularne_2">4. Drogi regularne</h2>
<div class="sectionbody">
<div class="paragraph"><p>Oprócz routingu RESTful, Railsy obsługują także routing regularny - sposób na przetłumaczenie URL na odpowiednie kontrolery i akcje. Korzystając z tego rodzaju routingu, nie otrzymujesz ogromnej liczby automatycznie wygenerowanych dróg routingu. Zamiast tego, musisz samodzielnie ustawić każdą drogę obsługiwaną przez aplikację.</p></div>
<div class="paragraph"><p>Chociaż routing RESTful stał się standardem dla frameworku Rails, w wielu wypadkach prostszy routing regularny w zupełności wystarcza. Możesz też łączyć te dwa typy routingu wewnątrz jednej aplikacji. Ogólnie rzecz biorąc, powinno się preferować routing RESTful zawsze, gdy <em>jest to możliwe</em>, ponieważ sprawia on, że aplikacja jest prostsza do napisania. Nie musisz jednak na siłę dopasowywać każdego elementu swojej aplikacji do frameworku w stylu RESTful.</p></div>
<h3 id="_podstawowe_parametry">4.1. Podstawowe parametry</h3>
<div class="paragraph"><p>Gdy tworzymy drogę regularną, mamy do dyspozycję serię różnych symboli, kojarzonych przez Railsy z elementami nadchodzącego żądania HTTP. Dwa z nich mają szczególne znaczenie: <tt>:controller</tt> służy do wskazania kontrolera w naszej aplikacji, a <tt>:action</tt> - do wskazania akcji danego kontrolera. Rozważmy na przykład jedną z domyślnych dróg routingu Rails:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id'</span></tt></pre></div></div>
<div class="paragraph"><p>Jeśli nadchodzące żądanie dotyczące zasobu <tt>/photos/show/1</tt> będzie przetworzone przez ten wpis (ponieważ nie pasowało do żadnej wcześniejszej drogi w pliku routes.rb), w rezultacie zostanie wywołana akcja <tt>show</tt> kontrolera <tt>Photo</tt>, a parametr <tt>params[:id]</tt> będzie miał przypisaną wartość 1.</p></div>
<h3 id="_komponenty_z_dzik_kart">4.2. Komponenty z "dziką kartą"</h3>
<div class="paragraph"><p>Możesz określić dowolną liczbę symboli w drodze regularnej. Wszystko inne niż <tt>:controller</tt> lub <tt>:action</tt> będzie dostępne dla docelowej akcji w tablicy parametrów. Jeśli więc zdefiniujesz następującą drogę routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id/:user_id'</span></tt></pre></div></div>
<div class="paragraph"><p>Nadchodzący URL <tt>/photos/show/1/2</tt> będzie przekierowany do akcji <tt>show</tt> kontrolera <tt>Photos</tt>. <tt>params[:id]</tt> będzie miał ustawioną wartość 1, a <tt>params[:user_id]</tt> - wartość 2.</p></div>
<h3 id="_tekst_statyczny">4.3. Tekst statyczny</h3>
<div class="paragraph"><p>Podczas tworzenia drogi routingu możesz też dodać do niej statyczny tekst. W takim przypadku, obsłużone przez nią będą jedynie żądania, które posiadają dokładnie taką treść:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id/with_user/:user_id'</span></tt></pre></div></div>
<div class="paragraph"><p>Taka droga odpowie na URL typu <tt>photos/show/1/with_user/2</tt>.</p></div>
<h3 id="_parametry_a_cucha_zapytania_querystring">4.4. Parametry łańcucha zapytania (querystring)</h3>
<div class="paragraph"><p>Routing Railsów automatycznie pobierze każdy parametr zawarty wewnątrz łańcucha zapytania i udostępni go wewnątrz tablicy asocjacyjnej <tt>params</tt>. Załóżmy przykładową drogę routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id'</span></tt></pre></div></div>
<div class="paragraph"><p>Nadchodzący URL <tt>photos/show/1?user_id=2</tt> zostanie skierowany do akcji <tt>show</tt> kontrolera <tt>Photos</tt>. Zmienna <tt>params[:id]</tt> będzie ustawiona na 1, a dodatkowo dostępna będzie zmienna <tt>params[:user_id]</tt> o wartości 2.</p></div>
<h3 id="_domy_lne_definicje">4.5. Domyślne definicje</h3>
<div class="paragraph"><p>Nie musisz używać jawnie symboli <tt>:controller</tt> i <tt>:action</tt> wewnątrz drogi routingu. Możesz zawrzeć domyślne wartości tych dwóch parametrów w tablicy asocjacyjnej:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'photos/:id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photos'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'show'</span></tt></pre></div></div>
<div class="paragraph"><p>Przy takiej drodze routingu, nadchodzący URL <tt>/photos/12</tt> zostanie skierowany do domyślnej akcji <tt>show</tt> kontrolera <tt>Photos</tt>.</p></div>
<div class="paragraph"><p>Możesz także określić inne domyślne wartości, korzystając z opcji <tt>:defaults</tt>. Dotyczy to także parametrów, które nie są zawarte wprost nigdzie w drodze routingu, na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'photos/:id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photos'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'show'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>defaults <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>format <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'jpg'</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Przy takiej drodze routingu, nadchodzący URL <tt>photos/12</tt> będzie skierowany do akcji <tt>show</tt> kontrolera <tt>Photos</tt> z parametrem <tt>params[:format]</tt> o wartości <tt>jpg</tt>.</p></div>
<h3 id="_drogi_nazwane_2">4.6. Drogi nazwane</h3>
<div class="paragraph"><p>Drogi regularne nie muszą korzystać z metody <tt>connect</tt>. Możesz użyć dowolnej innej nazwy, tworząc tym samym _drogę nazwaną_. Oto przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>logout <span style="color: #FF0000">'/logout'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'sessions'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'destroy'</span></tt></pre></div></div>
<div class="paragraph"><p>Taki wpis spowoduje dwie rzeczy. Po pierwsze, żądania dotyczące zasobu <tt>/logout</tt> będą przesłane do metody <tt>destroy</tt> kontrolera <tt>Sessions</tt>. Po drugie, Railsy ustanowią helpery <tt>logout_path</tt> i <tt>logout_url</tt>.</p></div>
<h3 id="_wymagania_dr_g_routingu">4.7. Wymagania dróg routingu</h3>
<div class="paragraph"><p>Możesz skorzystać z opcji <tt>:requirements</tt> by wymusić dany format dla każdego z parametrów w drodze:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'photo/:id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photos'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'show'</span><span style="color: #990000">,</span>
 <span style="color: #990000">:</span>requirements <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>id <span style="color: #990000">=&gt;</span> <span style="color: #FF6600">/[A-Z]\d{5}/</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Taka droga routingu zareaguje na nadchodzący URL typy <tt>/photo/A12345</tt>. Możesz zapisać taką drogę jeszcze krócej:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'photo/:id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photos'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'show'</span><span style="color: #990000">,</span>
  <span style="color: #990000">:</span>id <span style="color: #990000">=&gt;</span> <span style="color: #FF6600">/[A-Z]\d{5}/</span></tt></pre></div></div>
<h3 id="_warunki_dr_g_routingu">4.8. Warunki dróg routingu</h3>
<div class="paragraph"><p>Warunki dróg (wprowadzane przy użyciu opcji <tt>:conditions</tt>) zostały stworzone aby wprowadzić ograniczenia na drogach. Obecnie jedynym obsługiwanym warunkiem jest <tt>:method</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'photo/:id'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photos'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'show'</span><span style="color: #990000">,</span>
 <span style="color: #990000">:</span>conditions <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>method <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>get <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Tak jak w przypadku dróg RESTful, możesz zdefiniować typy żądań <tt>:get</tt>, <tt>:post</tt>, <tt>:put</tt>, <tt>:delete</tt> lub <tt>:any</tt>.</p></div>
<h3 id="_uog_lnianie_dr_g_routingu">4.9. Uogólnianie dróg routingu</h3>
<div class="paragraph"><p>Uogólnianie dróg routingu służy wprowadzeniu parametru, który pasuje do wszystkich elementów drogi. Na przykład:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">'photo/*other'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photos'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'unknown'</span><span style="color: #990000">,</span></tt></pre></div></div>
<div class="paragraph"><p>Taka droga obsłuży zarówno żądanie odnoszące się do <tt>photo/12</tt>, jak i <tt>photo/long/path/to/12</tt>, przypisując zmiennej w tablicy asocjacyjnej <tt>params[:other]</tt> pozostałą część ścieżki.</p></div>
<h3 id="_opcje_dr_g_routingu">4.10. Opcje dróg routingu</h3>
<div class="paragraph"><p>Możesz użyć opcji <tt>:with_options</tt> by uprościć definicję grupy podobnych dróg routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>with_options <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'photo'</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>photo<span style="color: #990000">|</span>
  photo<span style="color: #990000">.</span>list <span style="color: #FF0000">''</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'index'</span>
  photo<span style="color: #990000">.</span>delete <span style="color: #FF0000">':id/delete'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'delete'</span>
  photo<span style="color: #990000">.</span>edit <span style="color: #FF0000">':id/edit'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">'edit'</span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Znaczenie tej opcji zmalało z momentem wprowadzenia dróg RESTful.</p></div>
</div>
<h2 id="_formaty_i_polecenie_respond_to">5. Formaty i polecenie respond_to</h2>
<div class="sectionbody">
<div class="paragraph"><p>Istnieje jeszcze jeden sposób, by routing dopasowywał odpowiedź aplikacji na podstawie różnic w nadchodzącym żądaniu HTTP: poprzez tworzenie odpowiedzi w zależności od tego jaki format jest akceptowalny dla żądania. W routingu Rails, możesz kontrolować tę opcję korzystając w definicji drogi routingu z parametru <tt>:format</tt>.</p></div>
<div class="paragraph"><p>Załóżmy na przykład, że druga z domyślnych dróg w pliku <tt>routes.rb</tt> ma postać:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id.:format'</span></tt></pre></div></div>
<div class="paragraph"><p>Taka droga routingu będzie obsługiwała żadania takie jak <tt>/photo/edit/1.xml</tt> lub <tt>/photo/show/2.rss</tt>. Wewnątrz właściwego kodu akcji, możemy wymusić różne zachowanie w zależności od żądanego formatu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
  format<span style="color: #990000">.</span>html <span style="font-style: italic"><span style="color: #9A1900"># return the default template for HTML</span></span>
  format<span style="color: #990000">.</span>xml <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@photo</span><span style="color: #990000">.</span>to_xml <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<h3 id="_rozr_nianie_formatu_na_podstawie_nag_wka_dania_http">5.1. Rozróżnianie formatu na podstawie nagłówka żądania HTTP</h3>
<div class="paragraph"><p>Jeśli parametr <tt>:format</tt> nie występuje w definicji drogi routingu, Railsy automatycznie uznają zawartość nagłówka HTTP Accept za żądany format odpowiedzi.</p></div>
<h3 id="_rozpoznawalne_typy_mime">5.2. Rozpoznawalne typy MIME</h3>
<div class="paragraph"><p>Domyślnie Railsy rozpoznają typy <tt>html</tt>, <tt>json</tt>, <tt>csv</tt>, <tt>xml</tt>, <tt>rss</tt>, <tt>atom</tt> i <tt>yaml</tt> jako akceptowalne formaty odpowiedzi. Jeśli potrzebujesz innego typu, możesz go zdefiniować w konfiguracji środowiska:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>Mime<span style="color: #990000">::</span>Type<span style="color: #990000">.</span>register <span style="color: #FF0000">"image/jpg"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>jpg</tt></pre></div></div>
</div>
<h2 id="_drogi_domy_lne_2">6. Drogi domyślne</h2>
<div class="sectionbody">
<div class="paragraph"><p>Podczas tworzenia nowej aplikacji w Railsach, plik <tt>routes.rb</tt> jest uzupełniany dwoma domyślnymi drogami routingu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id'</span>
map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id.:format'</span></tt></pre></div></div>
<div class="paragraph"><p>Te drogi zapewniają rozsądną obsługę dla wielu URL, pod warunkiem że nie używasz routingu RESTful.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Domyślne drogi routingu sprawią, że każda akcja każdego kontrolera Twojej aplikacji będzie osiągalna za pomocą żądania typu GET. Jeśli planujesz korzystać z dróg RESTful i dróg nazwanych, powinieneś "wykomentować" drogi domyślne, by uniemożliwić dostęp do kontrolerów żądaniami niechcianych typów. Jeśli jednak na etapie tworzenia aplikacji domyślne drogi routingu będą aktywne, musisz upewnić się, że nie wykorzystujesz ich gdzieś przypadkowo - w przeciwnym wypadku po ich wyłączeniu możesz liczyć się z dziwnym zachowaniem aplikacji.</td>
</tr></table>
</div>
</div>
<h2 id="_pusta_droga_routingu">7. Pusta droga routingu</h2>
<div class="sectionbody">
<div class="paragraph"><p>Nie należy mylić drogi domyślnej z drogą pustą. Ta ostatnia ma jedno unikalne założenie: służy do obsługi żądań odnoszących się do katalogu głównego strony. Jeśli twoja strona ma adres example.com, to żądania do <tt>http://example.com</tt> lub <tt>http://example.com/</tt> będą obsługiwane przez drogę pustą.</p></div>
<h3 id="_u_ywanie_map_root">7.1. Używanie map.root</h3>
<div class="paragraph"><p>Preferowanym sposobem obsługi drogi pustej jest użycie komendy <tt>map.root</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>root <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"pages"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"main"</span></tt></pre></div></div>
<div class="paragraph"><p>Użycie metody <tt>root</tt> zasygnalizuje Railsom, że droga obsługuje żądania dotyczące katalogu głównego strony.</p></div>
<div class="paragraph"><p>Dla poprawy czytelności, możesz zdefiniować w wywołaniu <tt>map.root</tt> stworzoną wcześniej drogę nazwaną:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>index <span style="color: #FF0000">'index'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"pages"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"main"</span>
map<span style="color: #990000">.</span>root <span style="color: #990000">:</span>index</tt></pre></div></div>
<div class="paragraph"><p>Z powodu ustalonej kolejności przetwarzania pliku <tt>routes.rb</tt>, droga nazwana musi zostać określona <em>przed</em> odwołaniem <tt>map.root</tt>.</p></div>
<h3 id="_czenie_pustego_a_cucha_znak_w">7.2. Łączenie pustego łańcucha znaków</h3>
<div class="paragraph"><p>Możesz też określić pustą drogę wprost, poprzez dopasowanie do pustego ciągu znaków:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">''</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"pages"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"main"</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeśli masz wrażenie, że pusta droga nie działa w Twojej aplikacji poprawnie, upewnij się, że usunąłeś plik <tt>public/index.html</tt> z drzewa katalogów.</td>
</tr></table>
</div>
</div>
<h2 id="_inspekcja_i_testowanie_dr_g_routingu">8. Inspekcja i testowanie dróg routingu</h2>
<div class="sectionbody">
<div class="paragraph"><p>Routowanie nie powinną być "czarną skrzynką" aplikacji, do której lepiej nigdy nie zaglądać. Railsy oferują wbudowane narzędzia, służące do inspekcji i testowania dróg.</p></div>
<h3 id="_przel_danie_istniej_cych_dr_g_routingu_poprzez_rake">8.1. Przelądanie istniejących dróg routingu poprzez Rake</h3>
<div class="paragraph"><p>Jeśli potrzebujesz kompletnej listy wszystkich dostępnych w aplikacji dróg routingu, użyj komendy <tt>rake routes</tt>. Zrzuci ona wszystkie drogi na wyjście konsoli, zachowując kolejność z jaką są one wpisane w pliku <tt>routes.rb</tt>. Wśród informacji dotyczących każdej drogi zobaczysz:</p></div>
<div class="ulist"><ul>
<li>
<p>
jej nazwę ścieżki (o ile została podana)
</p>
</li>
<li>
<p>
typ żądania HTTP (o ile droga nie odpowiada na wszystkie typy żądań)
</p>
</li>
<li>
<p>
wzorzec URL
</p>
</li>
<li>
<p>
parametry generowane przez ten URL
</p>
</li>
</ul></div>
<div class="paragraph"><p>Dla przykładu, oto mały wycinek wyników polecenia <tt>rake routes</tt> dla drogi RESTful:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>          users GET  /users          {:controller=&gt;"users", :action=&gt;"index"}
formatted_users GET  /users.:format  {:controller=&gt;"users", :action=&gt;"index"}
                POST /users          {:controller=&gt;"users", :action=&gt;"create"}
                POST /users.:format  {:controller=&gt;"users", :action=&gt;"create"}</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Z pewnością przekonasz się, że wyniki komendy <tt>rake routes</tt> są o wiele bardziej czytelne gdy poszerzysz okno terminala.</td>
</tr></table>
</div>
<h3 id="_testowanie_dr_g_routingu">8.2. Testowanie dróg routingu</h3>
<div class="paragraph"><p>Drogi routingu powinny być stałym punktem Twojej strategii testowania strony (podobnie jak reszta aplikacji). Railsy oferują trzy <a href="http://api.rubyonrails.com/classes/ActionController/Assertions/RoutingAssertions.html">wbudowane narzędzia</a> służące uproszczeniu tej procedury:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>assert_generates</tt>
</p>
</li>
<li>
<p>
<tt>assert_recognizes</tt>
</p>
</li>
<li>
<p>
<tt>assert_routing</tt>
</p>
</li>
</ul></div>
<h4 id="_tt_assert_generates_tt">8.2.1. <tt>Assert_generates</tt></h4>
<div class="paragraph"><p>Używamy <tt>assert_generates</tt> dla upewnienia się, że dany zestaw opcji wygeneruje wymaganą ścieżkę. Dotyczy to dróg domyślnych i dróg posiadających dodatkowe opcje:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>assert_generates <span style="color: #FF0000">"/photos/1"</span><span style="color: #990000">,</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"show"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>id <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"1"</span> <span style="color: #FF0000">}</span>
assert_generates <span style="color: #FF0000">"/about"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"pages"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"about"</span></tt></pre></div></div>
<h4 id="_tt_assert_recognizes_tt">8.2.2. <tt>Assert_recognizes</tt></h4>
<div class="paragraph"><p><tt>Assert_recognizes</tt> jest przeciwieństwem <tt>assert_generates</tt>. Sprawdza on, czy Rails rozpoznaje wskazaną ścieżkę i kieruje ją do wymaganego elementu aplikacji.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>assert_recognizes <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"show"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>id <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"1"</span> <span style="color: #FF0000">}</span><span style="color: #990000">,</span> <span style="color: #FF0000">"/photos/1"</span></tt></pre></div></div>
<div class="paragraph"><p>Możesz użyć dodatkowego argumentu <tt>:method</tt>, by sprecyzować typ żądania HTTP:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>assert_recognizes <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"create"</span> <span style="color: #FF0000">}</span><span style="color: #990000">,</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>path <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>method <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>post <span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Możesz także użyć helperów RESTful dla rozpoznania ścieżki drogi RESTful:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>assert_recognizes new_photo_url<span style="color: #990000">,</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>path <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>method <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>post <span style="color: #FF0000">}</span></tt></pre></div></div>
<h4 id="_tt_assert_routing_tt">8.2.3. <tt>Assert_routing</tt></h4>
<div class="paragraph"><p><tt>Assert_routing</tt> sprawdza obydwa aspekty routingu: sprawdza czy ścieżka wywołuje odpowiednie opcje oraz czy opcje generują odpowiednią ścieżkę. W zasadzie polega to na połączeniu funkcji <tt>assert_generates</tt> i <tt>assert_recognizes</tt>.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>assert_routing <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>path <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>method <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>post <span style="color: #FF0000">}</span><span style="color: #990000">,</span> <span style="color: #FF0000">{</span> <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"photos"</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"create"</span> <span style="color: #FF0000">}</span></tt></pre></div></div>
</div>
<h2 id="_changelog">9. Changelog</h2>
<div class="sectionbody">
<div class="paragraph"><p><a href="http://rails.lighthouseapp.com/projects/16213-rails-guides/tickets/3">Lighthouse ticket</a></p></div>
<div class="ulist"><ul>
<li>
<p>
October 4, 2008: Added additional detail on specifying verbs for resource member/collection routes , by <a href="../authors.html#mgunderloy">Mike Gunderloy</a>
</p>
</li>
<li>
<p>
September 23, 2008: Added section on namespaced controllers and routing, by <a href="../authors.html#mgunderloy">Mike Gunderloy</a>
</p>
</li>
<li>
<p>
September 10, 2008: initial version by <a href="../authors.html#mgunderloy">Mike Gunderloy</a>
</p>
</li>
</ul></div>
</div>

    </div>
  </div>
</body>
</html>
