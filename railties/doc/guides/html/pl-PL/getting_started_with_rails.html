<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Zaczynamy z Rails</title>
  <!--[if lt IE 8]>
  <script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js" type="text/javascript"></script>
  <![endif]-->
  <link href="stylesheets/base.css" media="screen" rel="Stylesheet" type="text/css" />
  <link href="stylesheets/forms.css" media="screen" rel="Stylesheet" type="text/css" />
  <link href="stylesheets/more.css" media="screen" rel="Stylesheet" type="text/css" />
</head>
<body>
  <div id="header" >
    <div id="logo">
      <a href="index.html" title="Ruby on Rails"><img src="images/rails_logo_remix.gif" alt="Rails" height="140" width="110" /></a>
    </div>

    <h1 id="site_title"><span>Ruby on Rails</span></h1>
    <h2 id="site_title_tagline">Sustainable productivity for web-application development</h2>

    <ul id="navMain">
      <li class="first-child"><a href="http://www.rubyonrails.org/" title="Ruby on Rails" class="ruby_on_rails">Ruby on Rails</a></li>
      <li><a class="manuals" href="index.html" title="Manuals Index">Guides Index</a></li>
    </ul>
  </div>

  <div id="container">
    
    <div id="sidebar">
      <h2>Chapters</h2>
      <ol>
          <li>
          <a href="#_co_obejmuje_przewodnik">Co obejmuje przewodnik?</a>
          </li>
          <li>
          <a href="#_co_to_s_railsy">Co to są Railsy?</a>
            <ul>
            
              <li><a href="#_architektura_mvc">Architektura MVC</a></li>
            
              <li><a href="#_sk_adniki_rails_w">Składniki Railsów</a></li>
            
              <li><a href="#_rest">REST</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_tworzenie_nowego_projektu_w_railsach">Tworzenie nowego projektu w Railsach</a>
            <ul>
            
              <li><a href="#_instalacja_rodowiska_rails">Instalacja środowiska Rails</a></li>
            
              <li><a href="#_tworzenie_bloga">Tworzenie bloga</a></li>
            
              <li><a href="#_konfiguracja_bazy_danych">Konfiguracja bazy danych</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_witaj_rails">Witaj Rails!</a>
            <ul>
            
              <li><a href="#_uruchamianie_serwera_www">Uruchamianie serwera WWW.</a></li>
            
              <li><a href="#_konfiguracja_strony_domowej_programu">Konfiguracja Strony Domowej Programu.</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_szybki_start_dzi_ki_rusztowaniu">Szybki start dzięki rusztowaniu.</a>
          </li>
          <li>
          <a href="#_tworzenie_obiektu">Tworzenie obiektu</a>
            <ul>
            
              <li><a href="#_uruchamianie_migracji">Uruchamianie Migracji</a></li>
            
              <li><a href="#_dodawanie_hiper_cza">Dodawanie hiperłącza.</a></li>
            
              <li><a href="#_praca_z_postami_w_przegl_darce">Praca z postami w przeglądarce</a></li>
            
              <li><a href="#_model">Model</a></li>
            
              <li><a href="#_sprawdzanie_poprawno_ci_danych">Sprawdzanie poprawności danych</a></li>
            
              <li><a href="#_u_ywanie_konsoli">Używanie konsoli</a></li>
            
              <li><a href="#_listowanie_post_w">Listowanie postów</a></li>
            
              <li><a href="#_personalizacja_layoutu">Personalizacja Layoutu</a></li>
            
              <li><a href="#_tworzenie_nowego_postu">Tworzenie nowego postu.</a></li>
            
              <li><a href="#_prezentacja_pojedynczego_postu">Prezentacja pojedynczego postu</a></li>
            
              <li><a href="#_edytowanie_post_w">Edytowanie postów</a></li>
            
              <li><a href="#_kasowanie_postu">Kasowanie Postu</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_wykorzystanie_zasady_dry">Wykorzystanie zasady DRY</a>
            <ul>
            
              <li><a href="#_u_ywanie_podszablon_w_do_eliminacji_widocznych_duplikat_w">Używanie podszablonów do eliminacji widocznych duplikatów.</a></li>
            
              <li><a href="#_u_ywanie_filtr_w_do_eliminacji_powt_rze_w_kontrolerze">Używanie filtrów do eliminacji powtórzeń w kontrolerze</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_dodawanie_drugiego_modelu">Dodawanie drugiego modelu</a>
            <ul>
            
              <li><a href="#_tworzenie_modelu">Tworzenie modelu</a></li>
            
              <li><a href="#_czenie_modeli">Łączenie modeli</a></li>
            
              <li><a href="#_dodawanie_cie_ek">Dodawanie Ścieżek</a></li>
            
              <li><a href="#_tworzenie_kontrolera">Tworzenie Kontrolera</a></li>
            
              <li><a href="#_budowanie_widok_w">Budowanie Widoków</a></li>
            
              <li><a href="#_przy_czanie_komentarzy_do_post_w">Przyłączanie komentarzy do postów</a></li>
            
            </ul>
          </li>
          <li>
          <a href="#_co_dalej">Co dalej?</a>
          </li>
          <li>
          <a href="#_zmiany">Zmiany</a>
          </li>
      </ol>
    </div>
    
    <div id="content">
        <h1>Zaczynamy z Rails</h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Ten przewodnik jest wprowadzeniem do Ruby on Rails. Po jego przeczytaniu będziesz zaznajomiony z:</p></div>
<div class="ulist"><ul>
<li>
<p>
Instalowaniem Railsów, tworzeniem nowej aplikacji oraz zestawianiem połączenia z bazę danych
</p>
</li>
<li>
<p>
Ogólnym układem aplikacji
</p>
</li>
<li>
<p>
Podstawami modelu MVC (Model, View, Controller) oraz architektury RESTful
</p>
</li>
<li>
<p>
Szybkim generowaniem podstawowych elementów aplikacji
</p>
</li>
</ul></div>
</div>
</div>
<h2 id="_co_obejmuje_przewodnik">1. Co obejmuje przewodnik?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Ten przewodnik jest przeznaczony dla początkujących, którzy chcą rozpocząć tworzenie aplikacji opartych na Railsach. Nie zakładamy, że masz wcześniejsze doświadczenia z Railsami. Niemniej jednak, do jak najlepszego wykorzystania tego przewodnika, konieczne jest:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.ruby-lang.org/en/downloads/">Ruby</a> - podstawowa wiedza z zakresu języka Ruby
</p>
</li>
<li>
<p>
<a href="http://rubyforge.org/frs/?group_id=126">RubyGems</a> - narzędzie do dystrybuowania i instalowania paczek zawierających moduły i rozszerzenia języka Ruby
</p>
</li>
<li>
<p>
Zarządzanie bazą danych <a href="http://www.sqlite.org/">SQLite</a> (preferowane), <a href="http://www.mysql.com/">MySQL</a> lub <a href="http://www.postgresql.org/">PostgreSQL</a>
</p>
</li>
</ul></div>
<div class="paragraph"><p>Zdecydowanie zaleca się zapoznanie z językiem Ruby przed rozpoczęciem przygody z Railsami. Znacznie łatwiej jest śledzić, co się dzieje w Railsach, rozumiejąc podstawowy składni Ruby. Railsy nie będą w stanie w magiczny sposób zrewolucjonizować sztuki pisania aplikacji internetowych, jeżeli nie masz doświadczenia w używaniu języka. W Internecie istnieje kilka dobrych darmowych źródeł pomocnych w nauce języka Ruby, w tym:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.humblelittlerubybook.com/">Mr. Neigborly&#8217;s Humble Little Ruby Book</a>
</p>
</li>
<li>
<p>
<a href="http://www.rubycentral.com/book/">Programming Ruby</a>
</p>
</li>
<li>
<p>
<a href="http://poignantguide.net/ruby/">Why&#8217;s (Poignant) Guide to Ruby</a>
</p>
</li>
</ul></div>
</div>
<h2 id="_co_to_s_railsy">2. Co to są Railsy?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Railsy są internetowo rozwijanym frameworkiem napisanym w języku Ruby. Zostały one tak zaprojektowane, aby ułatwić programowanie aplikacji internetowych, dostarczając zbiór wytycznych, od których każdy deweloper musi zacząć. Pozwalają one na pisanie krótszego kodu, niż jest to możliwe podczas używania większości innych języków i frameworków. Poza tym, projektanci uważają, że wykorzystanie Railsów przy tworzeniu aplikacjach internetowych sprawia przyjemność.</p></div>
<div class="paragraph"><p>Railsy są "upartym" oprogramowaniem. Oznacza to, że są stworzone, aby zachęcić do wyboru najlepszej drogi, a w niektórych przypadkach -  by zniechęcić do wyboru alternatywy. Jeśli nauczysz się "The Rails Way", odkryjesz ogromny wzrost produktywności. Jednak jeżeli podczas pracy z Railsami pozostaniesz przy nawykach charakterystycznych dla programowania w innych językach lub będziesz wykorzystywać wzorce, których już kiedyś się nauczyłeś, efekty mogą nie być aż tak pomyślne.</p></div>
<div class="paragraph"><p>Filozofia Railsów zawiera kilka zasad:</p></div>
<div class="ulist"><ul>
<li>
<p>
DRY - "Don&#8217;t Repeat Yourself" (Nie powtarzaj się) - sugeruje, że pisanie tego samego kodu przez cały czas jest złe.
</p>
</li>
<li>
<p>
Konwencja Ponad Konfiguracją - Railsy wychodzą z założenia, że wiesz co chcesz zrobić i w jaki sposób, dlatego nie zmuszają Cię do samodzielnego ustawiania każdego najdrobniejszego szczegółu
</p>
</li>
<li>
<p>
REST jest najlepszym wzorem dla aplikacji internetowych - organizowanie aplikacji wokół zasobów i standardowych zapytań HTTP jest najszybszym możliwym rozwiązaniem
</p>
</li>
</ul></div>
<h3 id="_architektura_mvc">2.1. Architektura MVC</h3>
<div class="paragraph"><p>Railsy są zorganizowane wokół trzech komponentów aplikacji: modelu (model), widoku (view), kontrolera (controller), co w skrócie nazywany MVC. Wzorzec MVC obejmuje:</p></div>
<div class="ulist"><ul>
<li>
<p>
Odizolowanie logiki biznesowej od interfejsu użytkownika
</p>
</li>
<li>
<p>
Łatwość utrzymania kodu zgodnie z zasadą DRY
</p>
</li>
<li>
<p>
Wyraźne zaznaczenie, gdzie powinny się znajdować różne elementy kodu, co ułatwia zarządzenie tym kodem
</p>
</li>
</ul></div>
<h4 id="_models">2.1.1. Models</h4>
<div class="paragraph"><p>Model przedstawia informacje (dane) dla aplikacji i reguły do manipulowania tymi danymi. W przypadku Railsów, modele są głównie wykorzystywane do zarządzania zasadami interakcji z odpowiednią tabelą bazy danych. W większości przypadków jednej tabeli bazy danych odpowiada jeden model w Twojej aplikacji. Większość Twoich aplikacji realizujących logikę biznesową będzie skoncentrowana w modelach.</p></div>
<h4 id="_widoki">2.1.2. Widoki</h4>
<div class="paragraph"><p>Widoki tworzą interfejs użytkownika aplikacji. W Railsach, widoki są często plikami HTML zawierającymi kod w języku Ruby, wykonujący zadania związane wyłącznie z prezentacją danych. Przede wszystkim są odpowiedzialne za dostarczanie danych do przeglądarki internetowej lub innego narzędzia, które jest używane do oglądania efektów działania Twojej aplikacji.</p></div>
<h4 id="_kontrolery">2.1.3. Kontrolery</h4>
<div class="paragraph"><p>Kontrolery "sklejają" modele i widoki. W Railsach odpowiadają za przetwarzanie żądań przychodzących z przeglądarki internetowej, pozyskiwanie danych z modeli i przekazywanie ich do widoków w celu prezentacji.</p></div>
<h3 id="_sk_adniki_rails_w">2.2. Składniki Railsów</h3>
<div class="paragraph"><p>Rails dostarcza pełnego zestawu komponentów do tworzenia aplikacji internetowych. Są to:</p></div>
<div class="ulist"><ul>
<li>
<p>
Action Controller
</p>
</li>
<li>
<p>
Action View
</p>
</li>
<li>
<p>
Active Record
</p>
</li>
<li>
<p>
Action Mailer
</p>
</li>
<li>
<p>
Active Resource
</p>
</li>
<li>
<p>
Railties
</p>
</li>
<li>
<p>
Active Support
</p>
</li>
</ul></div>
<h4 id="_action_controller">2.2.1. Action Controller</h4>
<div class="paragraph"><p>Action Controller jest komponentem zarządzającym kontrolerami w Railsowej aplikacji. Framework kontrolera Action Controller przetwarza przychodzące do aplikacji Railsowej zapytania, wydobywa z nich parametry i wysyła je do odpowiedniej akcji. Usługi świadczone przez Action Controller obejmują zarządzanie sesją (session), szablon renderowania (template rendering) i przekierowanie zarządzania.</p></div>
<h4 id="_action_view">2.2.2. Action View</h4>
<div class="paragraph"><p>Action View zarządza widokami Twojej Railsowej aplikacji. Możne tworzyć zarówno HTML i XML wyjście domyślnie. Action View zarządza szablonami renderowania, w tym zagnieżdżonymi szablonami i podszablonami (partial templates) i zagnieżdżonych szablonów, wykorzystując wbudowane wsparcie AJAX.</p></div>
<h4 id="_active_record">2.2.3. Active Record</h4>
<div class="paragraph"><p>Active Record jest podstawą dla modeli w Railsowej aplikacji. Dostarcza on niezależną bazę danych, dostarcza podstawowe funkcje aplikacji - CRUD (create, read, update and delete - utwórz, odczytaj, aktualizuj, usuń), zaawansowane znajdywanie możliwości i zdolność do wiązania modeli ze sobą pomiędzy różnymi usługami.</p></div>
<h4 id="_action_mailer">2.2.4. Action Mailer</h4>
<div class="paragraph"><p>Action Mailer to framework dla tworzenia usług e-mail. Action Mailer może być uzywany do wysyłania e-maili w oparciu o elastyczne szablony lub do odbioru i przetwarzania przychodzących wiadomości.</p></div>
<h4 id="_active_resource">2.2.5. Active Resource</h4>
<div class="paragraph"><p>Active Resource dostarcza framework dla zarządzania połączeniami pomiędzy obiektami biznesowymi internetowych serwisów RESTful. Implementuje sposób mapowania obiektów internetowych na lokalne obiekty w oparciu o semantykę CRUD.</p></div>
<h4 id="_railties">2.2.6. Railties</h4>
<div class="paragraph"><p>Railties jest rdzeniem kodu Rails, który buduje nowe aplikacje Railsowe i skleja ze sobą różne frameworki w Railsowych aplikacjach.</p></div>
<h4 id="_active_support">2.2.7. Active Support</h4>
<div class="paragraph"><p>Active Support jest obszernym zbiorem użytecznych klas oraz standardowych bibliotek rozszerzeń dla Ruby, które są wykorzystywane w Railsach, zarówno przez rdzeń kodu, jak i Twoje aplikacje.</p></div>
<h3 id="_rest">2.3. REST</h3>
<div class="paragraph"><p>Praca doktorska Roya Fieldinga <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Architectural Styles and the Design of Network-based Software Architectures</a> jest powszechnie uznawana za podstawę działania architektury RESTful. Na szczęście, nie musisz czytać tego całego dokumentu, aby zrozumieć, jak działa REST w Rails. REST (Representational State Transfer) jest stylem architektury oprogramowania sprowadzającym się do dwóch podstawowych zasad:</p></div>
<div class="ulist"><ul>
<li>
<p>
Korzystanie z zasobów identyfikatorów (które na potrzeby tego przewodnika możesz traktować jakoadresy URL) w celu reprezentacji tych zasobów
</p>
</li>
<li>
<p>
Przesyłanie reprezentacji stanów tego zasobu pomiędzy elementami systemu.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Na przykład, aplikacja Railsowa takie zapytanie:</p></div>
<div class="paragraph"><p><tt>DELETE /photos/17</tt></p></div>
<div class="paragraph"><p>będzie rozumiała jako odniesienia do źródła zdjęcia o ID 17, oraz wskaże żądane działanie - usunięcie tego źródła. REST to naturalny styl architektury aplikacji internetowych i Railsy czynią go jeszcze bardziej naturalnym, poprzez korzystanie z konwencji, które pozwalają na nie przejmowanie się złożnością RESTful oraz różnicami pomiędzy przeglądarkami.</p></div>
<div class="paragraph"><p>Jeśli chciałbyś dowiedzieć się czegoś więcej na temat REST jako styl architektonicznego, polecam bardziej przystępne źródła od tezy Fieldinga:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.infoq.com/articles/rest-introduction">Krótkie wprowadzenie do REST Stefana Tilkov</a>
</p>
</li>
<li>
<p>
<a href="http://bitworking.org/news/373/An-Introduction-to-REST">Wprowadzenie do REST - Joe Gregorio</a> (video tutorial)
</p>
</li>
<li>
<p>
<a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">REST - artykuł w Wikipedii</a>
</p>
</li>
</ul></div>
</div>
<h2 id="_tworzenie_nowego_projektu_w_railsach">3. Tworzenie nowego projektu w Railsach</h2>
<div class="sectionbody">
<div class="paragraph"><p>Z pomocą tego przewodnika, będziesz mógł utworzyć projekt prostego bloga w Railsach. Zanim przystąpisz do tworzenia aplikacji, upewnij się, że masz zainstalowane Railsy.</p></div>
<h3 id="_instalacja_rodowiska_rails">3.1. Instalacja środowiska Rails</h3>
<div class="paragraph"><p>W większości przypadków, najprostszym sposobem zainstalowania Railsów jest skorzystania z RubyGems:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ gem install rails</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Istnieją pewne szczególne okoliczności, w których można zastosować alternatywną strategię instalacji:</td>
</tr></table>
</div>
<div class="ulist"><ul>
<li>
<p>
Jeśli pracujesz w systemie Windows, będzie Ci łatwiej zainstalować <a href="http://instantrails.rubyforge.org/wiki/wiki.pl">Instant Rails</a>. Powinieneś jednak uważać instalując Instant Rails, aby wersja Railsów była aktualna. Ponadto, Windowsowa wersja Railsów jest ogólnie mniej przyjazna w użyciu niż na innych systemach operacyjnych. Jeśli to możliwe, polecamy korzystanie z Linuksowej maszyny wirtualnej.
</p>
</li>
<li>
<p>
Jeżeli chcesz być na bieżąco z najnowszymi zmianami w środowisku Rails, proponujemy skopiowanie kodu źródłowego z  <a href="http://github.com/rails/rails/tree/master">githuba</a> Aczkolwiek nie jest to zalecane dla początkujących
</p>
</li>
</ul></div>
<h3 id="_tworzenie_bloga">3.2. Tworzenie bloga</h3>
<div class="paragraph"><p>Otwórz terminal i przejdź do folderu, w którym posiadasz odpowiednie uprawnienia do tworzenia plików, a następnie wpisz polecenie:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rails blog</tt></pre></div></div>
<div class="paragraph"><p>To stworzy Railsową aplikację, która korzysta z bazy danych SQLite. Jeśli wolisz korzystać z MySQL, uruchom zamiast tego polecenie:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rails blog -d mysql</tt></pre></div></div>
<div class="paragraph"><p>A jeśli używasz PostgreSQL do przechowywania danych, zastosuj polecenie:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rails blog -d postgresql</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Uruchamiając raili -h możesz zobaczyć wszystkie akceptowane przez aplikację Railsową przełączniki. :</td>
</tr></table>
</div>
<div class="paragraph"><p>Po utworzeniu aplikacji, przejdź do odpowiedniego folderu, aby móc kontynuować swoją pracę:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd blog</tt></pre></div></div>
<div class="paragraph"><p>Railsy utworzy folder o nazwie "blog" w Twoim roboczym katalogu. Otwórz ten folder i przyjrzyj się jego zawartości. Podczas pracy z tym przewodnikiem, w większości będziemy korzystać z folderu app/, ale poniżej możesz zapoznać się z podstawowymi funkcjami, które domyślnie utworzą Railsy.</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead valign="top">
<tr>
<th align="left">File/Folder </th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table"><tt>README</tt></p></td>
<td align="left"><p class="table">Jest to krótka instrukcja dla danej aplikacji. Użyj jej, aby poinformować innych między innymi o tym, jak działa Twoja aplikacja i jak ją można uruchomić.</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>Rakefile</tt></p></td>
<td align="left"><p class="table">Plik ten zawiera listę działań aplikacji, które można uruchomić poprzez terminal.</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>app/</tt></p></td>
<td align="left"><p class="table">Folder zawiera kontrolery, modele i widoki dla danej aplikacji. Na tym folderze będziemy koncentrować się w dalszej części tego przewodnika.</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>config/</tt></p></td>
<td align="left"><p class="table">Folder zawierający pliki konfiguracyjne dla aplikacji, odpowiadające za sposoby uruchamiania, bazę danych, ścieżki dostępu etc.</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>db/</tt></p></td>
<td align="left"><p class="table">Pokazuje aktualny schemat bazy danych, jak również migracje (migration) baz danych.</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>doc/</tt></p></td>
<td align="left"><p class="table">Pełna dokumentacja Twojej aplikacji.</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>lib/</tt></p></td>
<td align="left"><p class="table">Dodatkowe moduły dla Twojej aplikacji, których nie uwzględniono w tym przewodniku</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>log/</tt></p></td>
<td align="left"><p class="table">Archiwum plików</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>public/</tt></p></td>
<td align="left"><p class="table">Jedyny całkowicie dostępny publicznie folder. Są to wszelkie zdjęcia, arkusze stylów (CSS),  To właśnie zdjęcia, JavaScript, arkuszy stylów (CSS), JavaScript i inne statyczne pliki wyjściowe</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>script/</tt></p></td>
<td align="left"><p class="table">Skrypty dostarczone przez Rails w celu wykonywania powtarzających się zadań, takich jak analiza porównawcza, instalowanie wtyczek (plugin) i uruchamianiu konsoli lub serwera WWW</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>test/</tt></p></td>
<td align="left"><p class="table">Testy jednostkowe, tak zwane "fixtures" oraz inne narzędzia służące do przeprowadzania testów.  Są one opisane w: <a href="../testing_rails_applications.html">Testowanie aplikacji Rails</a></p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>tmp/</tt></p></td>
<td align="left"><p class="table">Pliki tymczasowe</p></td>
</tr>
<tr>
<td align="left"><p class="table"><tt>vendor/</tt></p></td>
<td align="left"><p class="table">Miejsce na kod, którego sami nie napisaliśmy, ale chcemy wykorzystać (tak zwani "trzeci dostawcy"). W standardowej aplikacji środowiska Rails, zawiera Ruby Gems, kod źródłowy Rubiego (jeśli zastosujesz go w swoim projekcie) i wszystkie dodatkowe wtyczki z gotowym kodem.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_konfiguracja_bazy_danych">3.3. Konfiguracja bazy danych</h3>
<div class="paragraph"><p>Każda aplikacja Railsowa korzysta z bazy danych. Rodzaj baza danych, której używamy, jest określony w pliku konfiguracyjnym <tt>config/database.yml</tt>.
Jeśli otworzysz ten plik w nowej aplikacji Railsowej, zostanie wyświetlona domyślna konfiguracja bazy danych SQLite. Plik zawiera części dla trzech różnych środowisk, w których Rails może być uruchomiony domyślnie:</p></div>
<div class="ulist"><ul>
<li>
<p>
środowisko <tt>rozwojowe</tt> jest używane na komputerze programisty jako interfejs użytkownika
</p>
</li>
<li>
<p>
środowisko <tt>badawcze</tt> służy do uruchamiania automatycznych testów
</p>
</li>
<li>
<p>
środowisko <tt>produkcyjne</tt> jest używane podczas przystosowywania aplikacji dla zwykłych użytkowników
</p>
</li>
</ul></div>
<h4 id="_konfiguracja_bazy_danych_sqlite">3.3.1. Konfiguracja bazy danych SQLite</h4>
<div class="paragraph"><p>Railsy mają wbudowaną obsługę <a href="http://www.sqlite.org/">SQLite</a>, który jest lekką, nie obciążającą serwera aplikacją bazy danych. Podczas przeciążenia SQLite przez środowisko produkcyjne, wciąż dobrze działa środowisko testowe i rozwojowe. Railsy domyślnie używają SQLite tworząc nowy projekt, ale zawsze można to później zmienić.</p></div>
<div class="paragraph"><p>Poniżej prezentujemy częśc domyślnej konfiguracji pliku z informacji dla środowiska rozwojowego:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>development<span style="color: #990000">:</span>
  adapter<span style="color: #990000">:</span> sqlite3
  database<span style="color: #990000">:</span> db<span style="color: #990000">/</span>development<span style="color: #990000">.</span>sqlite3
  timeout<span style="color: #990000">:</span> <span style="color: #993399">5000</span></tt></pre></div></div>
<div class="paragraph"><p>Jeśli nie masz żadnej zainstalowanej bazy danych, najłatwiej będzie Ci skorzystać z SQLite, w czym może być pomocny Ruby Gems (Posiadacze Maca z OS X 10.5 lub nowszym mają to zainstalowane domyślnie):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ gem install sqlite3-ruby</tt></pre></div></div>
<h4 id="_konfiguracja_bazy_danych_mysql">3.3.2. Konfiguracja bazy danych MySQL</h4>
<div class="paragraph"><p>Jeżeli zdecydujesz się na używanie bazy danych MySQL, Twój plik <tt>config/database.yml</tt> będzie wyglądał trochę inaczej:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>development<span style="color: #990000">:</span>
  adapter<span style="color: #990000">:</span> mysql
  encoding<span style="color: #990000">:</span> utf8
  database<span style="color: #990000">:</span> blog_development
  username<span style="color: #990000">:</span> root
  password<span style="color: #990000">:</span>
  socket<span style="color: #990000">:</span> <span style="color: #FF6600">/tmp/</span>mysql<span style="color: #990000">.</span>sock</tt></pre></div></div>
<div class="paragraph"><p>Ta konfiguracja powinna działac bez problemu, jeśli Twoja instalacja MySQLa nie ma wprowadzonego hasła dla super-uzytkownika (root user). Jeśli jednak jest inaczej, koniecznie zmień nazwę użytkownika oraz hasło w powyższym kodzie.</p></div>
<h4 id="_konfiguracja_bazy_danych_postgresql">3.3.3. Konfiguracja Bazy Danych PostgreSQL</h4>
<div class="paragraph"><p>Używając PostgreSQL Twój <tt>config/database.yml</tt> zostanie zmodyfikowany do pracy z tą bazą danych:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>development<span style="color: #990000">:</span>
  adapter<span style="color: #990000">:</span> postgresql
  encoding<span style="color: #990000">:</span> unicode
  database<span style="color: #990000">:</span> blog_development
  username<span style="color: #990000">:</span> blog
  password<span style="color: #990000">:</span></tt></pre></div></div>
<div class="paragraph"><p>Konieczna jest zmiana nazwy użytkownika oraz hasła w kodzie dla części projektowej,</p></div>
<h4 id="_tworzenie_bazy_danych">3.3.4. Tworzenie Bazy Danych</h4>
<div class="paragraph"><p>Teraz, gdy masz już skonfigurowaną bazę danych, czas by Railsy stworzyły dla ciebie pustą bazę danych. Możesz to zrobić uruchamiając komendę "rake":</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rake db<span style="color: #990000">:</span>create</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">"Rake" jest poleceniem startującym ogólnego zastosowania, które Railsy używają do wielu rzeczy. By zobaczyć dostępne dla nich komendy uruchom "rake -T". :</td>
</tr></table>
</div>
</div>
<h2 id="_witaj_rails">4. Witaj Rails!</h2>
<div class="sectionbody">
<div class="paragraph"><p>Jednym z tradycyjnych sposobów uczenia się nowego języka jest pobieżne przeglądnięcie jego tekstu. By tak zrobić w Railsach, konieczne jest stworzenie przynajmniej kontrolera oraz widoku.. Na szczęście możesz to zrobić używając pojedynczej komendy, wpisując ją do terminala:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ script/generate controller home index</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeżeli używasz Windowsa, lub gdy twój Ruby jest skonfigurowany w niestandardowy sposób, możliwe że będziesz potrzebował przekazać komendy <tt>script</tt> Railsów bezpośrednio do Ruby&#8217;ego: <tt>ruby script/generate controller home index</tt>.</td>
</tr></table>
</div>
<div class="paragraph"><p>Railsy stworzyły dla Ciebie parę plików, włączając w to <tt>app/views/home/index.html.erb</tt> - czyli szablon, który będzie używany do pokazywania efektów <tt>index</tt> action (method) w <tt>home</tt> kontrolerze. Otwórz ten plik w Twoim edytorze tekstów i dopisz do niego tę pojedynczą linijkę kodu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">&lt;h1&gt;</span></span>Hello, Rails!<span style="font-weight: bold"><span style="color: #0000FF">&lt;/h1&gt;</span></span></tt></pre></div></div>
<h3 id="_uruchamianie_serwera_www">4.1. Uruchamianie serwera WWW.</h3>
<div class="paragraph"><p>W chwili obecnej, za pomocą jedynie dwóch komend, masz gotowy i działający Railsowy program! Uruchamiając przeglądarkę na swoim komputerze programisty, za pomocą kolejnej komendy startowej: $ script/Server, będziesz mógł go zobaczyć.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ script/server</tt></pre></div></div>
<div class="paragraph"><p>Domyślnie spowoduje to odpalenie instancji serwera aplikacyjnego Mongrel. By zobaczyć jak działa Twój program, otwórz okno przeglądarki i przejdź do <tt>http://localhost:3000</tt>. Powinieneś zobaczyć Railsową, domyślną stronę informacyjną:</p></div>
<div class="paragraph"><p><span class="image">
<img src="images/rails_welcome.png" alt="Welcome Aboard screenshot" title="Welcome Aboard screenshot" />
</span></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">By zatrzymać serwer WWW naciśnij Ctrl+C w oknie terminalu podczas jego działania. Generalnie, Railsy w "trybie tworzenia" (development mode) nie wymagają zatrzymywania serwera, by wprowadzić Twoje zmiany w plikach - zostaną one automatycznie wprowadzone na serwer.</td>
</tr></table>
</div>
<div class="paragraph"><p>Ekran powitalny jest pierwszą próbą dla nowego programu napisanego w Railsach - upewnia nas, że oprogramowanie którym dysponujemy jest poprawnie skonfigurowana do działania strony. Aby ją zobaczyć, przejdź do <tt>http://localhost:3000/home/index</tt>.</p></div>
<h3 id="_konfiguracja_strony_domowej_programu">4.2. Konfiguracja Strony Domowej Programu.</h3>
<div class="paragraph"><p>Prawdopodobnie chcesz zamienić domyślną stronę startową ze stroną Twojego programu. Pierwszym krokiem jest wykasowanie z niego strony domyślnej:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rm public/index<span style="color: #990000">.</span>html</tt></pre></div></div>
<div class="paragraph"><p>Powinieneś teraz wskazać Railsowi gdzie Twoja strona domowa jest zlokalizowana. Otwórz plik <tt>config/routes.rb</tt> w swoim edytorze -  jest on plikiem routingowy (<em>routing file</em>) Twojego programu. Zawiera wpisy w specjalnym DSL (specyficzny język domeny) które pokazują Railsowi w jaki sposób połączyć żądania kontrolerów oraz akcji. Na dole tego pliku znajdują się domyślne ścieżki (<em>default routes</em>):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id'</span>
map<span style="color: #990000">.</span>connect <span style="color: #FF0000">':controller/:action/:id.:format'</span></tt></pre></div></div>
<div class="paragraph"><p>Domyślne ścieżki przenoszą proste żądania, takie jak <tt>/home/index</tt>: Railsy tłumaczą je w postaci prośby do akcji <tt>index</tt> w <tt>home</tt> kontrolerze. Kolejny przykład, <tt>/posts/edit/1</tt> uruchomi akcję <tt>edit</tt> w <tt>posts</tt> kontrollera z <tt>id</tt> 1.</p></div>
<div class="paragraph"><p>By połączyć Twoją stronę domową, będziesz potrzebować kolejnej linii do pliku routingu, powyżej domyślnej ścieżki:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>root <span style="color: #990000">:</span>controller <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"home"</span></tt></pre></div></div>
<div class="paragraph"><p>Ta linijka ilustruje jeden mały kawałek podejścia zwanego „konwencja ponad konfiguracją” ("convention over configuration"): jeżeli nie podasz żadnej akcji, Railsy założą domyślnie akcję <tt>index</tt>.</p></div>
<div class="paragraph"><p>Po przejściu do strony <tt>http://localhost:3000</tt> , zobaczysz widok <tt>home/index</tt> .</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Więcej informacji na temat routingu znajdziesz w <a href="../routing_outside_in.html">Rails Routing from the Outside In</a>.</td>
</tr></table>
</div>
</div>
<h2 id="_szybki_start_dzi_ki_rusztowaniu">5. Szybki start dzięki rusztowaniu.</h2>
<div class="sectionbody">
<div class="paragraph"><p>Railsowe rusztowanie (<em>scaffolding</em>) jest szybkim sposobem na stworzenia znacznej części programu. Jeśli chcesz stworzyć modele, widoki i kontrolery dla nowych zasobów w pojedynczej operacji, to jest to odpowiednim narzędziem dla Ciebie.</p></div>
</div>
<h2 id="_tworzenie_obiektu">6. Tworzenie obiektu</h2>
<div class="sectionbody">
<div class="paragraph"><p>W przypadku programów takich jak blog, możesz zacząć od stworzenia obiektu typu Post („Post resource”), który odpowiada za pojedynczy post blogu, w oparciu o rusztowania. By to zrobić, wprowadź następującą komendę do terminalu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ script/generate scaffold Post name<span style="color: #990000">:</span>string title<span style="color: #990000">:</span>string content<span style="color: #990000">:</span>text</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Chociaż rusztowanie pozwoli Ci szybko rozpocząć pisanie programu, ten uniwersalny, działający wszędzie kod raczej nie będzie idealnie pasować do Twojej aplikacji. W większości przypadków będziesz musiał samodzielnie dokonać w nim zmian. Wielu doświadczonych programistów Rails unika używania rusztowań na rzecz pisania większości kodu źródłowego od podstaw, bez używania gotowych wzorców.</td>
</tr></table>
</div>
<div class="paragraph"><p>Generator rusztowania zbuduje w Twoim programie 14 plików, wspólnie z paroma folderami, i jeden dodatkowo edytuje. Oto krótki przegląd tego co tworzy:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead valign="top">
<tr>
<th align="left">File                                          </th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td align="left"><p class="table">app/models/post.rb</p></td>
<td align="left"><p class="table">Model Postu</p></td>
</tr>
<tr>
<td align="left"><p class="table">db/migrate/20081013124235_create_posts.rb</p></td>
<td align="left"><p class="table">Migracja do tworzenia tabel postów w Twojej bazie danych (nazwa którą wpiszesz będzie zawierać rózne znaczniki czasowe)</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/views/posts/index.html.erb</p></td>
<td align="left"><p class="table">Widok dla indeksu wszystkich postów</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/views/posts/show.html.erb</p></td>
<td align="left"><p class="table">Widok dla pojedynczego postu</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/views/posts/new.html.erb</p></td>
<td align="left"><p class="table">Widok dla tworzenia nowego postu</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/views/posts/edit.html.erb</p></td>
<td align="left"><p class="table">Widok dla edycji postu</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/views/layouts/posts.html.erb</p></td>
<td align="left"><p class="table">Widok określający całościowy wygląd i działanie innych widoków dla postów.</p></td>
</tr>
<tr>
<td align="left"><p class="table">public/stylesheets/scaffold.css</p></td>
<td align="left"><p class="table">Poprawianie wyglądu przy użyciu szablonu stylów CSS</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/controllers/posts_controller.rb</p></td>
<td align="left"><p class="table">Kontroler postów</p></td>
</tr>
<tr>
<td align="left"><p class="table">test/functional/posts_controller_test.rb</p></td>
<td align="left"><p class="table">Testy funkcjonalności dla kontrolerów postów</p></td>
</tr>
<tr>
<td align="left"><p class="table">app/helpers/posts_helper.rb</p></td>
<td align="left"><p class="table">Helpery (helper functions) używane przy widokach postów</p></td>
</tr>
<tr>
<td align="left"><p class="table">config/routes.rb</p></td>
<td align="left"><p class="table">Plik zawierający informacje routingowe dla postów</p></td>
</tr>
<tr>
<td align="left"><p class="table">test/fixtures/posts.yml</p></td>
<td align="left"><p class="table">Posty testowe</p></td>
</tr>
<tr>
<td align="left"><p class="table">test/unit/post_test.rb</p></td>
<td align="left"><p class="table">Testy funkcjonalności dla modeli postów</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_uruchamianie_migracji">6.1. Uruchamianie Migracji</h3>
<div class="paragraph"><p>Jednym z produktów komendy: <tt>script/generate scaffold</tt> jest <em>database migration</em>. Migracje są jedną z klas Ruby, które upraszczają tworzenie i modyfikowanie baz danych tabel. Railsy używają komendy „rake” by uruchamiać migracje, ale możliwe jest jej wycofanie po tym jak, została dodana do Twojej bazy danych. Nazwy plików migracji uwzględniają znaczniki czasowe by zapewnić ich przetwarzanie w porządku, w jakim zostały stworzone.</p></div>
<div class="paragraph"><p>Oto co znajdziesz, gdy zajrzysz do pliku <tt>db/migrate/20090113124235_create_posts.rb</tt> (jego nazwa u Ciebie może się trochę różnić):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> CreatePosts <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Migration
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #0000FF">self</span></span><span style="color: #990000">.</span>up
    create_table <span style="color: #990000">:</span>posts <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>t<span style="color: #990000">|</span>
      t<span style="color: #990000">.</span>string <span style="color: #990000">:</span>name
      t<span style="color: #990000">.</span>string <span style="color: #990000">:</span>title
      t<span style="color: #990000">.</span>text <span style="color: #990000">:</span>content

      t<span style="color: #990000">.</span>timestamps
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #0000FF">self</span></span><span style="color: #990000">.</span>down
    drop_table <span style="color: #990000">:</span>posts
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Gdybyś chciał zawrzeć ten kod w słowach, brzmiałby on mniej więcej tak: gdy migracja jest uruchomiona, tworzy tabelę o nazwie <tt>posts</tt> z dwoma szeregami kolumn (<tt>name</tt> i <tt>title</tt>) i tekst kolumny (<tt>content</tt>), a wraz z nią pola znaczników czasu by śledzić jej tworzenie oraz aktualizowanie. Więcej szczegółów na temat sposobu pisania migracji znajdziesz w przewodniku <a href="../migrations.html">Rails Database Migrations</a>.</p></div>
<div class="paragraph"><p>Teraz możesz użyć komendy „rake” by uruchomić migracje:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rake db<span style="color: #990000">:</span>create
$ rake db<span style="color: #990000">:</span>migrate</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Ponieważ domyślnie pracujesz w środowisku rozwojowym, ta komenda wykona się na bazie danych zdefiniowanej w sekcji <tt>development</tt> pliku: <tt>config/database.yml</tt>.</td>
</tr></table>
</div>
<h3 id="_dodawanie_hiper_cza">6.2. Dodawanie hiperłącza.</h3>
<div class="paragraph"><p>By połączyć posty ze stroną domową, którą już stworzyłeś, możesz dodać do niej hiperłącze.
Otwórz <tt>/app/views/home/index.html.erb</tt> i dopisz do niego:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Hello<span style="color: #990000">,</span> Rails!<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;%= link_to "My Blog", posts_path %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Metoda <tt>link_to</tt> jest jednym z helperów pomagających kreować widoki w Railsach. Tworzy ona hiperłącze z tekstem do wyświetlenia oraz informacją, gdzie prowadzi – w tym wypadku ze ścieżką do postu.</p></div>
<h3 id="_praca_z_postami_w_przegl_darce">6.3. Praca z postami w przeglądarce</h3>
<div class="paragraph"><p>Teraz jesteś już gotowy do pracy z postami. Na początek przejdź do: <tt>http://localhost:3000</tt> i kliknij w link „Mój blog”.</p></div>
<div class="paragraph"><p><span class="image">
<img src="images/posts_index.png" alt="Posts Index screenshot" title="Posts Index screenshot" />
</span></p></div>
<div class="paragraph"><p>Jest to rezultat renderingu indeksu widoku Twoich postów. Aktualnie nie ma żadnych wpisów w bazie danych, ale zawsze możesz je utworzyć klikając w link „nowa wiadomość”. Możesz również przeglądać i edytować posty, a nawet je wykasować. Cały układ logiczny i HTML obsługuje pojedyncze polecenie <tt>script/generał scaffold</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">W  środowisku rozwojowym (na nim domyślnie pracujesz) z każdym żądaniem przeglądarki Railsy wgrywają od nowa program, dzięki czemu nie jest konieczne wyłączanie serwera WWW.</td>
</tr></table>
</div>
<div class="paragraph"><p>Gratulację! Wykonałeś swoją pierwszą aplikację w Railsach! Nadszedł czas, aby przyjrzeć się efektom pracy.</p></div>
<h3 id="_model">6.4. Model</h3>
<div class="paragraph"><p>Plik modelu <tt>app/models/post.rb</tt> jest tak samo prosty w obsłudze jak jego tworzenie:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Post <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Możliwości zmian tego pliku nie jest dużo – nie wolno jednak zapomnieć, że klasa <tt>Post</tt> dziedziczy z +ActiveRecord
</dt>
<dd>
<p>
Base+. Active Rekord za darmo dostarcza wielu funkcji dla Twoich Railsów, włączając w to podstawową baze danych operacji CRUD (Tworzenie, Czytanie, Aktualizowanie, Niszczenie) czy uwierzytelnianie danych – podobnie jak wsparcie  zaawansowanego wyszukiwania i zdolność do wiązania wielu różnych modeli jeden z drugim.
</p>
</dd>
</dl></div>
<h3 id="_sprawdzanie_poprawno_ci_danych">6.5. Sprawdzanie poprawności danych</h3>
<div class="paragraph"><p>Railsy są wyposażone w metodę, która pomoże Ci sprawdzić poprawność danych wysyłanych do modeli. Wprowadź poniższe zmiany do pliku: <tt>app/models/post.rb</tt></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Post <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
  validates_presence_of <span style="color: #990000">:</span>name<span style="color: #990000">,</span> <span style="color: #990000">:</span>title
  validates_length_of <span style="color: #990000">:</span>title<span style="color: #990000">,</span> <span style="color: #990000">:</span>minimum <span style="color: #990000">=&gt;</span> <span style="color: #993399">5</span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Dzięki nim mamy pewność, że każdy post będzie mieć nazwę oraz tytuł, a ten ostatni nie będzie miał mniej niż 5 znaków. Railsy mogą sprawdzać różne warunki w modelu, włączając w to obecność lub unikalność kolumn, ich format i istnienie związanych z nimi obiektów.</p></div>
<h3 id="_u_ywanie_konsoli">6.6. Używanie konsoli</h3>
<div class="paragraph"><p>By zobaczyć, jak sprawdzanie poprawności danych działa w praktyce, użyjemy konsoli. Konsola, w postaci linii komend, jest narzędziem, które umożliwia Ci wykonywanie kodów Ruby’ego w ramach działania Twojej aplikacji:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ script/console</tt></pre></div></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Możesz jej użyć do pracy z modelami Twojego programu
</dt>
<dd>
</dd>
</dl></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">&gt;&gt;</span> p <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>create<span style="color: #990000">(:</span>content <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"A new post"</span><span style="color: #990000">)</span>
<span style="color: #990000">=&gt;</span> <span style="font-style: italic"><span style="color: #9A1900">#&lt;Post id: nil, name: nil, title: nil, content: "A new post",</span></span>
created_at<span style="color: #990000">:</span> nil<span style="color: #990000">,</span> updated_at<span style="color: #990000">:</span> nil<span style="color: #990000">&gt;</span>
<span style="color: #990000">&gt;&gt;</span> p<span style="color: #990000">.</span>save
<span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #0000FF">false</span></span>
<span style="color: #990000">&gt;&gt;</span> p<span style="color: #990000">.</span>errors
<span style="color: #990000">=&gt;</span> <span style="font-style: italic"><span style="color: #9A1900">#&lt;ActiveRecord::Errors:0x23bcf0c @base=#&lt;Post id: nil, name: nil,</span></span>
title<span style="color: #990000">:</span> nil<span style="color: #990000">,</span> content<span style="color: #990000">:</span> <span style="color: #FF0000">"A new post"</span><span style="color: #990000">,</span> created_at<span style="color: #990000">:</span> nil<span style="color: #990000">,</span> updated_at<span style="color: #990000">:</span> nil<span style="color: #990000">&gt;,</span>
@<span style="color: #009900">errors</span><span style="color: #990000">=</span>{<span style="color: #FF0000">"name"</span><span style="color: #990000">=&gt;[</span><span style="color: #FF0000">"can't be blank"</span><span style="color: #990000">],</span> <span style="color: #FF0000">"title"</span><span style="color: #990000">=&gt;[</span><span style="color: #FF0000">"can't be blank"</span><span style="color: #990000">,</span>
<span style="color: #FF0000">"is too short (minimum is 5 characters)"</span><span style="color: #990000">]</span>}<span style="color: #990000">&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Powyższy kod przedstawia informację, jaką otrzymasz, gdy chcesz stworzyć nowy, ale błędny <tt>Post</tt>. Mechanizm jest następujący: przy próbie zapisania pojawia się wartość zwrotna <tt>false</tt> (oznaczającą, że zapisanie się nie powiodło), a kod wyszczególnia nam wszystkie znalezione błędy <tt>errors</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">W przeciwieństwie do serwerów WWW, konsola nie wprowadza automatycznie Twojego kodu na nowo z każdą linią. By dokonać zmian w Twoim modelu za pomocą konsoli, musisz użyć komendy <tt>reload!</tt></td>
</tr></table>
</div>
<h3 id="_listowanie_post_w">6.7. Listowanie postów</h3>
<div class="paragraph"><p>Najłatwiejszym sposobem na zapoznanie się z możliwościami programu jest kod, który listuje wszystkie posty. Otwórz plik: <tt>app/controllers/posts_controller.rb</tt> i przyjrzy się akcji <tt>index</tt></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> index
  <span style="color: #009900">@posts</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(:</span>all<span style="color: #990000">)</span>

  respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
    format<span style="color: #990000">.</span>html <span style="font-style: italic"><span style="color: #9A1900"># index.html.erb</span></span>
    format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@posts</span> <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Powyższy kod przypisuje przykładowa zmienną <tt>@posts</tt> do tablicy wszystkich postów w bazie danych. <tt>Post.find(:all)</tt> lub <tt>Post.all</tt> tworzy zawołanie dla modelu Post, który bezwarunkowo zwraca wszystkie posty z bazy danych.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Więcej informacji na temat znajdowania rekordów za pomocą Active Record znajdziesz w <a href="../finders.html">Active Record Finders</a></td>
</tr></table>
</div>
<div class="paragraph"><p>Blok <tt>respond_to</tt> obsługuje obydwa zawołania dla tej akcji - zarówno HTML jak i XML. Jeśli przejdziesz do <tt>http://localhost:3000/posts.xml</tt>, to zobaczysz wszystkie posty w formacie XML. Natomiast format HTML znajduję się w widoku <tt>app/views/posts</tt>, nazwanym tak samo jak odpowiadająca mu akcja. Rails same przenoszą wszystkie przykładowe zmienne z dostępnych akcji do widoku. Oto <tt>app/view/posts/index.html.erb</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Listing posts<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;table&gt;</span>
  <span style="color: #FF0000">&lt;tr&gt;</span>
    <span style="color: #FF0000">&lt;th&gt;</span>Name<span style="color: #FF0000">&lt;/th&gt;</span>
    <span style="color: #FF0000">&lt;th&gt;</span>Title<span style="color: #FF0000">&lt;/th&gt;</span>
    <span style="color: #FF0000">&lt;th&gt;</span>Content<span style="color: #FF0000">&lt;/th&gt;</span>
  <span style="color: #FF0000">&lt;/tr&gt;</span>

<span style="color: #FF0000">&lt;% for post in @posts %&gt;</span>
  <span style="color: #FF0000">&lt;tr&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%=h post.name %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%=h post.title %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%=h post.content %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%= link_to 'Show', post %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%= link_to 'Edit', edit_post_path(post) %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%= link_to 'Destroy', post, :confirm =&gt;</span> <span style="color: #FF0000">'Are you sure?'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>method <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>delete <span style="color: #990000">%&gt;</span><span style="color: #FF0000">&lt;/td&gt;</span>
  <span style="color: #FF0000">&lt;/tr&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>
<span style="color: #FF0000">&lt;/table&gt;</span>

<span style="color: #FF0000">&lt;br /&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'New post', new_post_path %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Widok wyświetla treść tablicy <tt>@posts</tt>, by pokazać zawartość oraz linki. Przyjrzymy się uważnie paru jego aspektom:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>h</tt> to helper metody który ujednolica wyświetlane danych, zapobiegający atakom „cross-site scripting”
</p>
</li>
<li>
<p>
<tt>link_to</tt> buduje hiperłącze dla określonej lokalizacji
</p>
</li>
<li>
<p>
<tt>edit_post_path</tt> jest helperem, który Railsy udostępniają w ramach routingu RESTful. Zobaczysz jeszcze sporo różnych rodzajów takich helperów dla wielu, znajdujących się w kontrolerze, akcji.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Więcej szczegółów na temat procesu renderingu znajdziesz w <a href="../layouts_and_rendering.html">Layouts and Rendering in Rails</a>.</td>
</tr></table>
</div>
<h3 id="_personalizacja_layoutu">6.8. Personalizacja Layoutu</h3>
<div class="paragraph"><p>Widok stanowi tylko część całego procesu przedstawiania przez HTML Twojej strony www. Railsy posiadają też różne gotowe layouty <tt>layouts</tt>, w których trzymane są widoki. Renderowanie widoku dla przeglądarki odbywa się poprzez umieszczanie widoku HTML wewnątrz layoutu HTML. Komenda <tt>script/generate scaffold</tt> automatycznie tworzy dla postu domyślny layout: <tt>app/views/layouts/posts.html.erb</tt>. Używając edytora zmodyfikuj go w następujący sposób:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">&lt;!</span>DOCTYPE html PUBLIC <span style="color: #FF0000">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span>
       <span style="color: #FF0000">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span><span style="color: #990000">&gt;</span>

<span style="color: #FF0000">&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"&gt;</span>
<span style="color: #FF0000">&lt;head&gt;</span>
  <span style="color: #FF0000">&lt;meta http-equiv="content-type" content="text/html;charset=UTF-8" /&gt;</span>
  <span style="color: #FF0000">&lt;title&gt;</span>Posts<span style="color: #990000">:</span> <span style="color: #FF0000">&lt;%= controller.action_name %&gt;&lt;/title&gt;</span>
  <span style="color: #FF0000">&lt;%= stylesheet_link_tag 'scaffold' %&gt;</span>
<span style="color: #FF0000">&lt;/head&gt;</span>
<span style="color: #FF0000">&lt;body style="background: #EEEEEE;"&gt;</span>

<span style="color: #FF0000">&lt;p style="color: green"&gt;&lt;%= flash[:notice] %&gt;&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;%= yield  %&gt;</span>

<span style="color: #FF0000">&lt;/body&gt;</span>
<span style="color: #FF0000">&lt;/html&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Gdy teraz odświeżysz stronę <tt>/posts</tt>, zobaczysz szare tło. Taki sam będzie używany dla wszystkich widoków postów.</p></div>
<h3 id="_tworzenie_nowego_postu">6.9. Tworzenie nowego postu.</h3>
<div class="paragraph"><p>Nowy post tworzy się za pomocą dwóch akcji. Pierwszą jest <tt>new</tt>, która tworzy nowy, pusty obiekt <tt>Post</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> new
  <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>new

  respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
    format<span style="color: #990000">.</span>html <span style="font-style: italic"><span style="color: #9A1900"># new.html.erb</span></span>
    format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@post</span> <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Widok <tt>new.html.erb</tt> wyświetli dla użytkownika pusty Post:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>New post<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;% form_for(@post) do |f| %&gt;</span>
  <span style="color: #FF0000">&lt;%= f.error_messages %&gt;</span>

  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :name %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :name %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :title %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :title %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :content %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_area :content %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.submit "Create" %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Back', posts_path %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Blok <tt>form_for</tt> jest używany do tworzenia formy HTML. Wewnątrz niego masz dostęp do metod, które umożliwiają zbudowanie różnorodnych sposobów kontroli form. Przykładowo: <tt>f.text_field :name</tt> prosi Railsy, by stworzyły w danej formie pole do wprowadzania tekstu i połączyły go z nazwą przykładowo wyświetlanego atrybutu. Możesz użyć tej metody tylko z takimi atrybutami modelu, które są podstawą formy (w tym wypadku <tt>name</tt>, <tt>title</tt>, i <tt>content</tt>). Rails preferencyjnie uzywa <tt>form_for</tt> do stworzenia surowego kodu HTML. Dzięki temu jest on bardziej zwięzły i wyraźnie widać związek formy z konkretnym modelem.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Jeśli potrzebujesz stworzyć formę HTML, która pokazuje dowolne pole, nie pasujące do modelu, powinieneś użyć metody <tt>form_tag</tt>, umożliwiające szybkie zbudowanie form, których nie trzeba łączyć z konkretnym modelem.</td>
</tr></table>
</div>
<div class="paragraph"><p>Gdy użytkownik kliknie na przycisk <tt>create</tt>, przeglądarka wyśle informacje zwrotną do metody kontrolera <tt>create</tt> (Railsy wiedzą, że mają posłużyć się metodą <tt>create</tt>, ponieważ forma jest wysyłana za pomocą żądania HTTP POST – jest to jedna z tych umownych rzeczy, o których wspomniałem wcześniej):</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> create
  <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>new<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post<span style="color: #990000">])</span>

  respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>save
      flash<span style="color: #990000">[:</span>notice<span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="color: #FF0000">'Post was successfully created.'</span>
      format<span style="color: #990000">.</span>html <span style="color: #FF0000">{</span> redirect_to<span style="color: #990000">(</span><span style="color: #009900">@post</span><span style="color: #990000">)</span> <span style="color: #FF0000">}</span>
      format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@post</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>status <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>created<span style="color: #990000">,</span> <span style="color: #990000">:</span>location <span style="color: #990000">=&gt;</span> <span style="color: #009900">@post</span> <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      format<span style="color: #990000">.</span>html <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"new"</span> <span style="color: #FF0000">}</span>
      format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>errors<span style="color: #990000">,</span> <span style="color: #990000">:</span>status <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>unprocessable_entity <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Akcja <tt>create</tt> tworzy nowy obiekt Post z danych przekazanymi przez użytkownika w formie, który Railsy udostępnią w <tt>params</tt>. Po zapisaniu nowego postu, używają one <tt>flash[:notice]</tt> do stworzenia wiadomości informacyjnej dla użytkownika oraz przekierowują do wyświetlanej akcji. Jeśli napotka jakiś problem, akcja <tt>create</tt> pokaże po raz drugi tylko widok new , ale wraz z wiadomością o błędzie.</p></div>
<div class="paragraph"><p>Railsy zapewniają hash: <tt>flash</tt> (zwyczajowo nazywany po prostu Flashem), stąd ta wiadomość może być przenoszona do innej akcji, dostarczaną użytkownikowi wraz z przydatnymi informacjami na temat statusu żądania. W przypadku <tt>create</tt> użytkownik nigdy nie widzi strony renderowanej podczas procesu tworzenia postu, ponieważ jest przekierowywany do nowego postu dopiero po zapisaniu rekordu. Flash przenosi informacje do następnej akcji, zatem gdy użytkownik jest przekierowywany spowrotem do akcji <tt>show</tt>, ukazuje mu się informacja „Post został stworzony”.</p></div>
<h3 id="_prezentacja_pojedynczego_postu">6.10. Prezentacja pojedynczego postu</h3>
<div class="paragraph"><p>Gdy klikniesz w link <tt>show</tt> dla postu na stronie głównej, przeniesie Cię ona do adresu <tt>http://localhost:3000/posts/1</tt> (lub podobnego). Railsy traktują to jako prośbę o zasoby skierowaną do akcji <tt>show</tt> i przechodzącą w <tt>1</tt> z parametrem <tt>:id</tt>. Akcja <tt>show</tt> wygląda tak:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> show
  <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>

  respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
    format<span style="color: #990000">.</span>html <span style="font-style: italic"><span style="color: #9A1900"># show.html.erb</span></span>
    format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@post</span> <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Akcja <tt>show</tt> używa <tt>Post.find</tt>, by znaleźć w bazie danych pojedynczy rekord z jej wartością id.
Railsy wyświetlają go używając <tt>show.html.erb</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Name<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @post.name %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Title<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @post.title %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Content<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @post.content %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>


<span style="color: #FF0000">&lt;%= link_to 'Edit', edit_post_path(@post) %&gt;</span> <span style="color: #990000">|</span>
<span style="color: #FF0000">&lt;%= link_to 'Back', posts_path %&gt;</span></tt></pre></div></div>
<h3 id="_edytowanie_post_w">6.11. Edytowanie postów</h3>
<div class="paragraph"><p>Edytowanie postu, podobnie jak tworzenie nowego, odbywa się dwustopniowo. Pierwszym krokiem jest polecenie <tt>edit_post_path(@post)</tt> odnoszące się do konkretnego postu. To wywołuje nam akcję <tt>edit</tt> w kontrolerze.:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> edit
  <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Po znalezieniu zażądanego postu, Railsy, by nam go pokazać, używają <tt>edit.html.erb</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Editing post<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;% form_for(@post) do |f| %&gt;</span>
  <span style="color: #FF0000">&lt;%= f.error_messages %&gt;</span>

  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :name %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :name %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :title %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :title %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :content %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_area :content %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.submit "Update" %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Show', @post %&gt;</span> <span style="color: #990000">|</span>
<span style="color: #FF0000">&lt;%= link_to 'Back', posts_path %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Składając stworzoną przez ten widok formę, odwołujemy się do akcji <tt>update</tt> wewnątrz kontrolera:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> update
  <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>

  respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>update_attributes<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post<span style="color: #990000">])</span>
      flash<span style="color: #990000">[:</span>notice<span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="color: #FF0000">'Post was successfully updated.'</span>
      format<span style="color: #990000">.</span>html <span style="color: #FF0000">{</span> redirect_to<span style="color: #990000">(</span><span style="color: #009900">@post</span><span style="color: #990000">)</span> <span style="color: #FF0000">}</span>
      format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> head <span style="color: #990000">:</span>ok <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      format<span style="color: #990000">.</span>html <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"edit"</span> <span style="color: #FF0000">}</span>
      format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> render <span style="color: #990000">:</span>xml <span style="color: #990000">=&gt;</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>errors<span style="color: #990000">,</span> <span style="color: #990000">:</span>status <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>unprocessable_entity <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>W akcji <tt>update</tt> Railsy używają na początku parametru <tt>:id</tt>, przechodząc z widoku edycji do rekordu zlokalizowanego w edytowanej bazie. <tt>Update_attributes</tt> wywołuje, a następnie wykorzystuje pozostałe parametry, które zażądaliśmy i dołącza je do tego rekordu. Jeśli wszystko pójdzie dobrze, to użytkownik jest przekierowywany do widoku <tt>show</tt> postu. Gdy jednak wystąpią jakieś problemy, Railsy zwracają go do <tt>edit</tt>, aby umożliwić mu poprawienie błędów.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Uważni czytelnicy zauważa zapewne, że deklaracja <tt>form_for</tt> jest identyczna dla widoków <tt>new</tt> i <tt>edit</tt>. Railsy generują inny kod dla każdego z formularzy, ponieważ są wystarczająco mądre, żeby zauważyć, że w jednym przypadku otrzymują nowy rekord, który jeszcze nie był zapisany, natomiast w drugim istniejący rekord, który już został zapisany w bazie danych. W produkcyjnej aplikacji Rails normalnie wyeliminowałbyś tę duplikację poprzez przeniesienie powtarzającego się kodu do podszablonu (<em>partial template</em>), który następnie byłby włączany w oba nadrzędne szablony. Jednakże generator rusztowań próbuje nie robić zbyt wielu założeń i tworzy kod, który łatwo modyfikować, jeżeli chcesz mieć różne formularze do akcji <tt>create</tt> i <tt>edit</tt>.</td>
</tr></table>
</div>
<h3 id="_kasowanie_postu">6.12. Kasowanie Postu</h3>
<div class="paragraph"><p>Ostatecznie, klikając na jednym z linków kategorii <tt>destroy</tt>, wysyłane jest powiązane id do akcji <tt>destroy</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">def</span></span> destroy
  <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
  <span style="color: #009900">@post</span><span style="color: #990000">.</span>destroy

  respond_to <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>format<span style="color: #990000">|</span>
    format<span style="color: #990000">.</span>html <span style="color: #FF0000">{</span> redirect_to<span style="color: #990000">(</span>posts_url<span style="color: #990000">)</span> <span style="color: #FF0000">}</span>
    format<span style="color: #990000">.</span>xml  <span style="color: #FF0000">{</span> head <span style="color: #990000">:</span>ok <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Metoda <tt>destroy</tt> modelu Active Record natychmiast usuwa odpowiadający mu rekord z bazy danych. Gdy to zostanie zrobione, nie ma już żadnego rekordu do wyświetlenia, dlatego Railsy przekierowują przeglądarkę użytkownika prosto do widoku index tego modelu.</p></div>
</div>
<h2 id="_wykorzystanie_zasady_dry">7. Wykorzystanie zasady DRY</h2>
<div class="sectionbody">
<div class="paragraph"><p>W tym miejscu warto byś przyjrzał się paru narzędziom, które Railsy oferują do usuwania duplikatów w Twoim kodzie. Szczególnie zwrócimy uwagę na te, które możesz czasami używać do ich eliminacji z widoków oraz na filtrach (<em>filters</em>), które są pomocne przy takich operacjach.</p></div>
<h3 id="_u_ywanie_podszablon_w_do_eliminacji_widocznych_duplikat_w">7.1. Używanie podszablonów do eliminacji widocznych duplikatów.</h3>
<div class="paragraph"><p>Jak już widziałeś wcześniej, widok generatora rusztowania dla akcji <tt>new</tt> i <tt>edit</tt> jest bardzo podobny. YMożesz przenieść dzielony kod prosto do podszablonu <tt>partial</tt>. Wymaga to edytowania widoków <tt>new</tt> i <tt>edit</tt> oraz dodania nowego szablonu. Nowy <tt>_form.html.erb</tt> szablon powinien być zapisany w tym samym folderze <tt>app/views/posts</tt> co plik, z którego został on wyprowadzony. Zauważ, że nazwa tego pliku zaczyna się od podkreślenia ' _ '(underscore) - jest to przyjęte przez Rails nazewnictwo dla podszablonów</p></div>
<div class="paragraph"><p><tt>new.html.erb</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>New post<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;%= render :partial =&gt;</span> <span style="color: #FF0000">"form"</span> <span style="color: #990000">%&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Back', posts_path %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p><tt>edit.html.erb</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Editing post<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;%= render :partial =&gt;</span> <span style="color: #FF0000">"form"</span> <span style="color: #990000">%&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Show', @post %&gt;</span> <span style="color: #990000">|</span>
<span style="color: #FF0000">&lt;%= link_to 'Back', posts_path %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p><tt>_form.html.erb</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;% form_for(@post) do |f| %&gt;</span>
  <span style="color: #FF0000">&lt;%= f.error_messages %&gt;</span>

  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :name %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :name %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :title, "title" %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :title %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :content %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_area :content %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.submit "Save" %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Teraz, gdy Railsy generują widok <tt>new</tt> lub <tt>edit</tt>, umieszczą go w szablonie <tt>_form</tt> we wskazanym punkcie. Zwróć uwagę na nazewnictwo dla szablonów: jeśli odnosisz się do jego formy o nazwie <tt>form</tt> wewnątrz widoku, odpowiadający mu plik to <tt>_form.html.erb</tt>, z podkreśleniem ' _ ' na początku.</p></div>
<div class="paragraph"><p>FWięcej informacji na temat szablonów uzyskasz w przewodniku <a href="../layouts_and_rendering.html">Layouts and Rending in Rails</a>.</p></div>
<h3 id="_u_ywanie_filtr_w_do_eliminacji_powt_rze_w_kontrolerze">7.2. Używanie filtrów do eliminacji powtórzeń w kontrolerze</h3>
<div class="paragraph"><p>W tym miejscu, jeśli popatrzysz na kontroler pod kątem postów, zobaczysz parę duplikatów:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> PostsController <span style="color: #990000">&lt;</span> ApplicationController
  <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> show
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
        <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> edit
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> update
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
    <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> destroy
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
    <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Cztery wystąpienia tej samej linii kodu są niezgodne z zasadą DRY. Railsy zapewniają filtry (<em>filters</em>) jako sposób na tego typu powtarzający się kod. W tym przypadku możesz poprawić pewne części używając <tt>before_filter</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> PostsController <span style="color: #990000">&lt;</span> ApplicationController
  before_filter <span style="color: #990000">:</span>find_post<span style="color: #990000">,</span> <span style="color: #990000">:</span>only <span style="color: #990000">=&gt;</span> <span style="color: #990000">[:</span>show<span style="color: #990000">,</span> <span style="color: #990000">:</span>edit<span style="color: #990000">,</span> <span style="color: #990000">:</span>update<span style="color: #990000">,</span> <span style="color: #990000">:</span>destroy<span style="color: #990000">]</span>
  <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> show
        <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> edit
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> update
    <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> destroy
    <span style="font-style: italic"><span style="color: #9A1900"># ...</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  private
    <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> find_post
      <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Railsy uruchamiają <em>before filters</em>  przed każdą akcją w kontrolerze. Możesz użyć polecenia <tt>:only</tt> do nałożenia ograniczenia przed filtrem, lub polecenia <tt>:except</tt> , by dokonać szczególnego pominięcia akcji tylko dla niektórych z nich. Railsy pozwalają Ci także definiować <em>after filters</em> , które uruchamiają się po przetworzeniu akcji, analogicznie jak otaczają ją <em>around filters</em> w trakcie jej przetwarzania. Do tego filtry mogą być także definiowane jako zewnętrzne klasy, by ułatwić przenoszenie ich pomiędzy kontrolerami.</p></div>
<div class="paragraph"><p>Więcej informacji o filtrach znajdziesz w przewodniku:<a href="actioncontroller_basics.html">Action Controller Basics</a>.</p></div>
</div>
<h2 id="_dodawanie_drugiego_modelu">8. Dodawanie drugiego modelu</h2>
<div class="sectionbody">
<div class="paragraph"><p>Skoro widziałeś już jak buduje się model przy użyciu rusztowania, nadszedł czas by dodać do tego programu drugi model. Na nim opierać się będą komentarze w postach na blogu.</p></div>
<h3 id="_tworzenie_modelu">8.1. Tworzenie modelu</h3>
<div class="paragraph"><p>Modele w Rails używają nazw w liczbie pojedynczej, a do komunikowania się z bazą danych nazw w liczbie mnogiej. Przyjęło się, że dla modelu, w którym znajdują się komentarze używamy nazwy danego komentarza. Nawet jeśli nie chcesz używać całej aparatury opartej na rusztowaniach, pamiętaj, że większość programistów piszących w Railsach dalej używa generatorów, by stworzyć takie rzeczy jak modele czy kontrolery. Aby stworzyć nowy model, wprowadź do terminalu następującą komendę:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ script/generate model Comment commenter<span style="color: #990000">:</span>string body<span style="color: #990000">:</span>text post<span style="color: #990000">:</span>references</tt></pre></div></div>
<div class="paragraph"><p>Wygeneruje ona 4 pliki:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>app/models/comment.rb</tt> - The model
</p>
</li>
<li>
<p>
+db/migrate/20081013214407_create_comments.rb - The migration
</p>
</li>
<li>
<p>
<tt>test/unit/comment_test.rb</tt> and <tt>test/fixtures/comments.yml</tt> - The test harness.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Przyjrzyjmy się:
 <tt>comment.rb</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Comment <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
  belongs_to <span style="color: #990000">:</span>post
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>To model bardzo podobny do <tt>post.rb</tt> , który widziałeś już wcześniej. Różnica znajduję się w lini  <tt>belongs_to :post</tt> , która uruchamia Active Record <em>association</em>. Nauczysz się więcej na temat powiązań w następnej części niniejszego poradnika.</p></div>
<div class="paragraph"><p>Dodatkowo do tego modelu Railsów tworzą migrację (migration), by stworzyć zgodną tabele bazy danych:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> CreateComments <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Migration
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #0000FF">self</span></span><span style="color: #990000">.</span>up
    create_table <span style="color: #990000">:</span>comments <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>t<span style="color: #990000">|</span>
      t<span style="color: #990000">.</span>string <span style="color: #990000">:</span>commenter
      t<span style="color: #990000">.</span>text <span style="color: #990000">:</span>body
      t<span style="color: #990000">.</span>references <span style="color: #990000">:</span>post

      t<span style="color: #990000">.</span>timestamps
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #0000FF">self</span></span><span style="color: #990000">.</span>down
    drop_table <span style="color: #990000">:</span>comments
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Linijka <tt>t.references</tt> tworzy zewnętrzny klucz kolumn dla połączeń pomiędzy dwoma modelami. Możesz spróbować uruchomić migracje:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ rake db<span style="color: #990000">:</span>migrate</tt></pre></div></div>
<div class="paragraph"><p>Railsy są na tyle sprytne, że wykonują tylko te migracje, które nie są sprzeczne z działającą bazą danych.</p></div>
<h3 id="_czenie_modeli">8.2. Łączenie modeli</h3>
<div class="paragraph"><p>Asocjacja Active Record pozwala Ci łatwo zdefiniować związek (asocjacje) pomiędzy dwoma modelami. W przypadku komentarzy oraz postów możesz go zapisać w ten sposób:</p></div>
<div class="ulist"><ul>
<li>
<p>
Każdy komentarz należy do jednego postu
</p>
</li>
<li>
<p>
Jeden post może mieć wiele komentarzy
</p>
</li>
</ul></div>
<div class="paragraph"><p>Tak naprawdę jest to bardzo podobne do składni jaką Railsy używają do deklarowania tych połączeń (asocjacji). Widziałeś już linie kodu umieszczoną w modelu komentarza, która przypisuje każdy komentarz do postu:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Comment <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
  belongs_to <span style="color: #990000">:</span>post
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Żeby dodać drugą stronę asocjacji konieczna jest edycja pliku <tt>post.rb</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> Post <span style="color: #990000">&lt;</span> ActiveRecord<span style="color: #990000">::</span>Base
  validates_presence_of <span style="color: #990000">:</span>name<span style="color: #990000">,</span> <span style="color: #990000">:</span>title
  validates_length_of <span style="color: #990000">:</span>title<span style="color: #990000">,</span> <span style="color: #990000">:</span>minimum <span style="color: #990000">=&gt;</span> <span style="color: #993399">5</span>
  has_many <span style="color: #990000">:</span>comments
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Dzięki tym dwóm deklaracjom w znaczny sposób automatyzujemy sposób zachowania się naszego programu. Praktycznie wygląda to tak: jeśli masz przykładową zmienną <tt>@post</tt> zawierającą post, możesz otrzymać wszystkie komentarze, które do niego należą, używając tablicy <tt>@post.comments</tt>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Po więcej informacji na temat asocjacji Active Record zajrzyj do przewodnika: <a href="../association_basics.html">Active Record Associations</a>.</td>
</tr></table>
</div>
<h3 id="_dodawanie_cie_ek">8.3. Dodawanie Ścieżek</h3>
<div class="paragraph"><p>Ścieżki (<em>Routes</em>) to wpisy do pliku <tt>config/routes.rb</tt> , które informują Railsy, jak interpretować nadchodzące żądania http, w celu wykonania danych akcji. Otwieranie określonego pliku oraz szukanie istniejącej linii odwołuje się do <tt>posts</tt> (znajduję się on w prawym górnym rogu pliku). Edytujemy go następująco:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>map<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>posts <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> <span style="color: #990000">|</span>post<span style="color: #990000">|</span>
  post<span style="color: #990000">.</span>resources <span style="color: #990000">:</span>comments
<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Tworzy to <tt>comments</tt> jako sposób zagnieżdżenia (<em>nested resource</em>) wewnątrz <tt>posts</tt>. Jest to kolejna część przechwytywania hierarchicznych zależności pomiędzy istniejącymi postami i komentarzami.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">Po więcej informacji na temat tworzenia ścieżek sięgnij do poradnika: <a href="../routing_outside_in.html">Rails Routing from the Outside In</a>.</td>
</tr></table>
</div>
<h3 id="_tworzenie_kontrolera">8.4. Tworzenie Kontrolera</h3>
<div class="paragraph"><p>Mając już przygotowany  model, czas zacząć tworzyć pasujący do niego kontroler. I znów posłużymy się generatorem:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ script/generate controller Comments index show new edit</tt></pre></div></div>
<div class="paragraph"><p>Tworzy to siedem plików:</p></div>
<div class="ulist"><ul>
<li>
<p>
<tt>app/controllers/comments_controller.rb</tt> - The controller
</p>
</li>
<li>
<p>
<tt>app/helpers/comments_helper.rb</tt> - A view helper file
</p>
</li>
<li>
<p>
<tt>app/views/comments/index.html.erb</tt> - The view for the index action
</p>
</li>
<li>
<p>
<tt>app/views/comments/show.html.erb</tt> - The view for the show action
</p>
</li>
<li>
<p>
<tt>app/views/comments/new.html.erb</tt> - The view for the new action
</p>
</li>
<li>
<p>
<tt>app/views/comments/edit.html.erb</tt> - The view for the edit action
</p>
</li>
<li>
<p>
<tt>test/functional/comments_controller_test.rb</tt> - The functional tests for the controller
</p>
</li>
</ul></div>
<div class="paragraph"><p>Kontroler zostanie wygenerowany z pustymi metodami oraz widokami dla każdej akcji, którą wywołasz poleceniem: <tt>script/generate controller</tt>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> CommentsController <span style="color: #990000">&lt;</span> ApplicationController
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> index
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> show
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> new
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> edit
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Należy to rozwinąć za pomocą kodu do aktualnego procesu żądania stosownie do każdej metody. By to rozjaśnić, poniżej znajduje się uproszczony przykład, który odpowiada jedynie na żądania wymagane przez HTML:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> CommentsController <span style="color: #990000">&lt;</span> ApplicationController
  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> index
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post_id<span style="color: #990000">])</span>
    <span style="color: #009900">@comments</span> <span style="color: #990000">=</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>comments
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> show
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post_id<span style="color: #990000">])</span>
    <span style="color: #009900">@comment</span> <span style="color: #990000">=</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>comments<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> new
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post_id<span style="color: #990000">])</span>
    <span style="color: #009900">@comment</span> <span style="color: #990000">=</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>comments<span style="color: #990000">.</span>build
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> create
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post_id<span style="color: #990000">])</span>
    <span style="color: #009900">@comment</span> <span style="color: #990000">=</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>comments<span style="color: #990000">.</span>build<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>comment<span style="color: #990000">])</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #009900">@comment</span><span style="color: #990000">.</span>save
      redirect_to post_comment_url<span style="color: #990000">(</span><span style="color: #009900">@post</span><span style="color: #990000">,</span> <span style="color: #009900">@comment</span><span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      render <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"new"</span>
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> edit
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post_id<span style="color: #990000">])</span>
    <span style="color: #009900">@comment</span> <span style="color: #990000">=</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>comments<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

  <span style="font-weight: bold"><span style="color: #0000FF">def</span></span> update
    <span style="color: #009900">@post</span> <span style="color: #990000">=</span> Post<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>post_id<span style="color: #990000">])</span>
    <span style="color: #009900">@comment</span> <span style="color: #990000">=</span> Comment<span style="color: #990000">.</span>find<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>id<span style="color: #990000">])</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #009900">@comment</span><span style="color: #990000">.</span>update_attributes<span style="color: #990000">(</span>params<span style="color: #990000">[:</span>comment<span style="color: #990000">])</span>
      redirect_to post_comment_url<span style="color: #990000">(</span><span style="color: #009900">@post</span><span style="color: #990000">,</span> <span style="color: #009900">@comment</span><span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      render <span style="color: #990000">:</span>action <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"edit"</span>
    <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">end</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">end</span></span></tt></pre></div></div>
<div class="paragraph"><p>Jak widzisz, jest to trochę bardziej skomplikowane niż wcześniejsze operacje w kontrolerze dla postów. Jest to uboczny efekt zagnieżdżania które tworzyłeś; każde żądanie komentarza musi pamiętać , z którym postem ten komentarz jest związany (do którego posta jest dołączony).</p></div>
<div class="paragraph"><p>Dodatkowo, kod posiada przewagę w niektórych rodzajach metod do asocjacji. Przykładowo - w metodzie <tt>new</tt> wywołuję się to tak:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">@comment</span> <span style="color: #990000">=</span> <span style="color: #009900">@post</span><span style="color: #990000">.</span>comments<span style="color: #990000">.</span>build</tt></pre></div></div>
<div class="paragraph"><p>Tworzy to nowy obiekt: <tt>Comment</tt> i ustanawia pole: <tt>post_id</tt> , które przyjmuje formę <tt>id</tt> zależną od obiektu <tt>Post</tt> w pojedynczej operacji.</p></div>
<h3 id="_budowanie_widok_w">8.5. Budowanie Widoków</h3>
<div class="paragraph"><p>Ponieważ opuściłeś rusztowanie, konieczne będzie ręczne zbudowanie widoków dla komentarzy. Przywoływanie <tt>script/generate controller</tt> da ci szkielet widoków, które jednak będą pozbawione aktualnej zawartości. Oto pierwszy krok do uszczegółowienia widoków komentarza.</p></div>
<div class="paragraph"><p>Widok <tt>index.html.erb</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Comments <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #FF0000">&lt;%= @post.title %&gt;&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;table&gt;</span>
  <span style="color: #FF0000">&lt;tr&gt;</span>
    <span style="color: #FF0000">&lt;th&gt;</span>Commenter<span style="color: #FF0000">&lt;/th&gt;</span>
    <span style="color: #FF0000">&lt;th&gt;</span>Body<span style="color: #FF0000">&lt;/th&gt;</span>
  <span style="color: #FF0000">&lt;/tr&gt;</span>

<span style="color: #FF0000">&lt;% for comment in @comments %&gt;</span>
  <span style="color: #FF0000">&lt;tr&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%=h comment.commenter %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%=h comment.body %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%= link_to 'Show', post_comment_path(@post, comment) %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%= link_to 'Edit', edit_post_comment_path(@post, comment) %&gt;&lt;/td&gt;</span>
    <span style="color: #FF0000">&lt;td&gt;&lt;%= link_to 'Destroy', post_comment_path(@post, comment), :confirm =&gt;</span> <span style="color: #FF0000">'Are you sure?'</span><span style="color: #990000">,</span> <span style="color: #990000">:</span>method <span style="color: #990000">=&gt;</span> <span style="color: #990000">:</span>delete <span style="color: #990000">%&gt;</span><span style="color: #FF0000">&lt;/td&gt;</span>
  <span style="color: #FF0000">&lt;/tr&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>
<span style="color: #FF0000">&lt;/table&gt;</span>

<span style="color: #FF0000">&lt;br /&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'New comment', new_post_comment_path(@post) %&gt;</span>
<span style="color: #FF0000">&lt;%= link_to 'Back to Post', @post %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Widok <tt>new.html.erb</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>New comment<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;% form_for([@post, @comment]) do |f| %&gt;</span>
  <span style="color: #FF0000">&lt;%= f.error_messages %&gt;</span>

  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :commenter %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :commenter %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :body %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_area :body %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.submit "Create" %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Back', post_comments_path(@post) %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Widok <tt>show.html.erb</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Comment on <span style="color: #FF0000">&lt;%= @post.title %&gt;&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Commenter<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @comment.commenter %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Comment<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @comment.body %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Edit', edit_post_comment_path(@post, @comment) %&gt;</span> <span style="color: #990000">|</span>
<span style="color: #FF0000">&lt;%= link_to 'Back', post_comments_path(@post) %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Widok <tt>edit.html.erb</tt> :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;h1&gt;</span>Editing comment<span style="color: #FF0000">&lt;/h1&gt;</span>

<span style="color: #FF0000">&lt;% form_for([@post, @comment]) do |f| %&gt;</span>
  <span style="color: #FF0000">&lt;%= f.error_messages %&gt;</span>

  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :commenter %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_field :commenter %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.label :body %&gt;&lt;br /&gt;</span>
    <span style="color: #FF0000">&lt;%= f.text_area :body %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
  <span style="color: #FF0000">&lt;p&gt;</span>
    <span style="color: #FF0000">&lt;%= f.submit "Update" %&gt;</span>
  <span style="color: #FF0000">&lt;/p&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Show', post_comment_path(@post, @comment) %&gt;</span> <span style="color: #990000">|</span>
<span style="color: #FF0000">&lt;%= link_to 'Back', post_comments_path(@post) %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Obecna, coraz większa komplikacja (w porównaniu do widoków dla zarządzania postami, które do tej pory widziałeś) ponownie pochodzi z konieczności żonglowania postami i ich komentarzami w tym samym czasie.</p></div>
<h3 id="_przy_czanie_komentarzy_do_post_w">8.6. Przyłączanie komentarzy do postów</h3>
<div class="paragraph"><p>Jako następny krok, zmodyfikuje widok: <tt>show.html.erb</tt> , by pokazać komentarze do tego postu oraz umożliwić zarządzanie nimi:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Name<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @post.name %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Title<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @post.title %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;p&gt;</span>
  <span style="color: #FF0000">&lt;b&gt;</span>Content<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
  <span style="color: #FF0000">&lt;%=h @post.content %&gt;</span>
<span style="color: #FF0000">&lt;/p&gt;</span>

<span style="color: #FF0000">&lt;h2&gt;</span>Comments<span style="color: #FF0000">&lt;/h2&gt;</span>
<span style="color: #FF0000">&lt;% @post.comments.each do |c| %&gt;</span>
        <span style="color: #FF0000">&lt;p&gt;</span>
          <span style="color: #FF0000">&lt;b&gt;</span>Commenter<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
          <span style="color: #FF0000">&lt;%=h c.commenter %&gt;</span>
        <span style="color: #FF0000">&lt;/p&gt;</span>

        <span style="color: #FF0000">&lt;p&gt;</span>
          <span style="color: #FF0000">&lt;b&gt;</span>Comment<span style="color: #990000">:</span><span style="color: #FF0000">&lt;/b&gt;</span>
          <span style="color: #FF0000">&lt;%=h c.body %&gt;</span>
        <span style="color: #FF0000">&lt;/p&gt;</span>
<span style="color: #FF0000">&lt;% end %&gt;</span>

<span style="color: #FF0000">&lt;%= link_to 'Edit', edit_post_path(@post) %&gt;</span> <span style="color: #990000">|</span>
<span style="color: #FF0000">&lt;%= link_to 'Back', posts_path %&gt;</span>
<span style="color: #FF0000">&lt;%= link_to 'Manage Comments', post_comments_path(@post) %&gt;</span></tt></pre></div></div>
<div class="paragraph"><p>Zapamiętaj, że każdy post ma swój osobny zbiór komentarzy, dostępny przez <tt>@post.comments</tt>. Wynika to z zadeklarowanych asocjacji w modelach. Ścieżka pomocnicza, taka jak <tt>post_comments_path</tt> pochodzi od zagnieżdżonej ścieżki deklaracji w <tt>config/routes.rb</tt> .</p></div>
</div>
<h2 id="_co_dalej">9. Co dalej?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Teraz, gdy masz przed sobą swój pierwszy Railsowy program, możesz go uatrakcyjniać, według własnych potrzeb. Ale nie musisz do wszystkiego dochodzić samodzielnie. Jeśli potrzebujesz wsparcia przy tworzeniu i uruchamianiu aplikacji Rails, możesz swobodnie korzystać z tych zasobów:</p></div>
<div class="ulist"><ul>
<li>
<p>
The <a href="http://guides.rubyonrails.org/">Ruby On Rails guides</a>
</p>
</li>
<li>
<p>
The <a href="http://groups.google.com/group/rubyonrails-talk">Ruby on Rails mailing list</a>
</p>
</li>
<li>
<p>
The #rubyonrails channel on irc.freenode.net
</p>
</li>
<li>
<p>
The <a href="http://wiki.rubyonrails.org/rails">Rails wiki</a>
</p>
</li>
</ul></div>
<div class="paragraph"><p>Railsy mają równiez wbudowaną pomoc, która możesz wywołać przy użyciu komendy rake w linii komend:</p></div>
<div class="ulist"><ul>
<li>
<p>
Uruchomienie <tt>rake doc:guides</tt> umieści kopię Rails Guides (przewodnik Rails) w folderze <tt>/doc/guides</tt> Twojego programu. Znajdujący się tam plik <tt>/doc/guides/index.html</tt> możesz przeglądać używając Twojej przeglądarki.
</p>
</li>
<li>
<p>
Uruchomienie <tt>rake doc:rails</tt> umieści kopię dokumentacji API dla Rails w folderze <tt>/doc/api</tt> Twojej aplikacji. Znajdujący się tam plik <tt>/doc/api/index.html</tt> możesz przeglądać używając Twojej przeglądarki.
</p>
</li>
</ul></div>
</div>
<h2 id="_zmiany">10. Zmiany</h2>
<div class="sectionbody">
<div class="paragraph"><p><a href="http://rails.lighthouseapp.com/projects/16213-rails-guides/tickets/2">Lighthouse ticket</a></p></div>
<div class="ulist"><ul>
<li>
<p>
November 3, 2008: Formatting patch from Dave Rothlisberger
</p>
</li>
<li>
<p>
November 1, 2008: First approved version by <a href="../authors.html#mgunderloy">Mike Gunderloy</a>
</p>
</li>
<li>
<p>
October 16, 2008: Revised based on feedback from Pratik Naik by <a href="../authors.html#mgunderloy">Mike Gunderloy</a> (not yet approved for publication)
</p>
</li>
<li>
<p>
October 13, 2008: First complete draft by <a href="../authors.html#mgunderloy">Mike Gunderloy</a> (not yet approved for publication)
</p>
</li>
<li>
<p>
October 12, 2008: More detail, rearrangement, editing by <a href="../authors.html#mgunderloy">Mike Gunderloy</a> (not yet approved for publication)
</p>
</li>
<li>
<p>
September 8, 2008: initial version by James Miller (not yet approved for publication)
</p>
</li>
</ul></div>
</div>

    </div>
  </div>
</body>
</html>
